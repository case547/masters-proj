{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.36689417099696586, "cur_kl_coeff": 0.19999999999999998, "cur_lr": 2e-05, "total_loss": 2.270295824483037, "policy_loss": -0.0013563843014708255, "vf_loss": 9.91817272901535, "vf_explained_var": -4.936009645462036e-09, "kl": 0.0001798126565526914, "entropy": 2.0792693788185717, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 640.5, "diff_num_grad_updates_vs_sampler_policy": 639.5}}, "num_env_steps_sampled": 512, "num_env_steps_trained": 512, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192, "num_env_steps_sampled": 512, "num_env_steps_trained": 512, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "timesteps_total": 512, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 8192, "timers": {"training_iteration_time_ms": 34476.684, "sample_time_ms": 29336.455, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 5136.341, "learn_throughput": 99.682, "synch_weights_time_ms": 3.887}, "counters": {"num_env_steps_sampled": 512, "num_env_steps_trained": 512, "num_agent_steps_sampled": 8192, "num_agent_steps_trained": 8192}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "0eff4_00000", "date": "2023-05-29_12-15-50", "timestamp": 1685358950, "time_this_iter_s": 34.482685565948486, "time_total_s": 34.482685565948486, "pid": 19016, "hostname": "JM-M16", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "grid4x4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 2e-05, "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.4, vf_clip_param=10.0, entropy_coeff=0.1, vf_loss_coeff=0.25, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 23423, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001BE3549C550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 34.482685565948486, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 2.3711111111111114, "ram_util_percent": 43.9377777777778, "gpu_util_percent0": 0.352, "vram_util_percent0": 0.00567626953125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.45467075806227514, "cur_kl_coeff": 0.09999999999999999, "cur_lr": 2e-05, "total_loss": 2.27810266148299, "policy_loss": -0.0057760461859288625, "vf_loss": 9.963334622234106, "vf_explained_var": -7.497146725654603e-09, "kl": 0.004454927299457267, "entropy": 2.074004386551678, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1920.5, "diff_num_grad_updates_vs_sampler_policy": 639.5}}, "num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 16384}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 16384, "num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "timesteps_total": 1024, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 16384, "timers": {"training_iteration_time_ms": 34854.5, "sample_time_ms": 29808.523, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 5042.025, "learn_throughput": 101.546, "synch_weights_time_ms": 3.951}, "counters": {"num_env_steps_sampled": 1024, "num_env_steps_trained": 1024, "num_agent_steps_sampled": 16384, "num_agent_steps_trained": 16384}, "done": false, "episodes_total": 0, "training_iteration": 2, "trial_id": "0eff4_00000", "date": "2023-05-29_12-16-25", "timestamp": 1685358985, "time_this_iter_s": 35.234415769577026, "time_total_s": 69.71710133552551, "pid": 19016, "hostname": "JM-M16", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "grid4x4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 2e-05, "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.4, vf_clip_param=10.0, entropy_coeff=0.1, vf_loss_coeff=0.25, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 23423, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001BE3549C550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 69.71710133552551, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 2.4127659574468083, "ram_util_percent": 44.127659574468076, "gpu_util_percent0": 0.12361702127659574, "vram_util_percent0": 0.00567626953125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5779022037633694, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": 2.2819243667647244, "policy_loss": -0.010882637997565326, "vf_loss": 9.987004227936268, "vf_explained_var": -1.0756775736808778e-08, "kl": 0.012820445830129756, "entropy": 2.045850702188909, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3200.5, "diff_num_grad_updates_vs_sampler_policy": 639.5}}, "num_env_steps_sampled": 1536, "num_env_steps_trained": 1536, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 24576}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 24576, "num_env_steps_sampled": 1536, "num_env_steps_trained": 1536, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "timesteps_total": 1536, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 24576, "timers": {"training_iteration_time_ms": 37385.096, "sample_time_ms": 32406.321, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 4973.313, "learn_throughput": 102.949, "synch_weights_time_ms": 5.461}, "counters": {"num_env_steps_sampled": 1536, "num_env_steps_trained": 1536, "num_agent_steps_sampled": 24576, "num_agent_steps_trained": 24576}, "done": false, "episodes_total": 0, "training_iteration": 3, "trial_id": "0eff4_00000", "date": "2023-05-29_12-17-08", "timestamp": 1685359028, "time_this_iter_s": 42.4462890625, "time_total_s": 112.16339039802551, "pid": 19016, "hostname": "JM-M16", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "grid4x4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 2e-05, "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.4, vf_clip_param=10.0, entropy_coeff=0.1, vf_loss_coeff=0.25, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 23423, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001BE3549C550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 112.16339039802551, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 2.6107142857142853, "ram_util_percent": 44.35178571428571, "gpu_util_percent0": 0.11142857142857143, "vram_util_percent0": 0.00567626953125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5700109376863111, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": 2.287349194381386, "policy_loss": -0.0016068838638602756, "vf_loss": 9.969789350032807, "vf_explained_var": -5.913898348808288e-09, "kl": 0.010777507913735463, "entropy": 2.040301382727921, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4480.5, "diff_num_grad_updates_vs_sampler_policy": 639.5}}, "num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 32768}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 32768, "num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "timesteps_total": 2048, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 32768, "timers": {"training_iteration_time_ms": 39263.558, "sample_time_ms": 34215.405, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 5042.551, "learn_throughput": 101.536, "synch_weights_time_ms": 5.096}, "counters": {"num_env_steps_sampled": 2048, "num_env_steps_trained": 2048, "num_agent_steps_sampled": 32768, "num_agent_steps_trained": 32768}, "done": false, "episodes_total": 0, "training_iteration": 4, "trial_id": "0eff4_00000", "date": "2023-05-29_12-17-53", "timestamp": 1685359073, "time_this_iter_s": 44.90194320678711, "time_total_s": 157.06533360481262, "pid": 19016, "hostname": "JM-M16", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "grid4x4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 2e-05, "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.4, vf_clip_param=10.0, entropy_coeff=0.1, vf_loss_coeff=0.25, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 23423, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001BE3549C550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 157.06533360481262, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 3.8017241379310347, "ram_util_percent": 44.39482758620691, "gpu_util_percent0": 0.3256896551724137, "vram_util_percent0": 0.00567626953125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.532797919108998, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": 2.2672408234793693, "policy_loss": -0.002171571255166782, "vf_loss": 9.897326475009322, "vf_explained_var": -7.497146725654603e-09, "kl": 0.009179249115368293, "entropy": 2.0537818709388374, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5760.5, "diff_num_grad_updates_vs_sampler_policy": 639.5}}, "num_env_steps_sampled": 2560, "num_env_steps_trained": 2560, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 40960}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 40960, "num_env_steps_sampled": 2560, "num_env_steps_trained": 2560, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "timesteps_total": 2560, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 40960, "timers": {"training_iteration_time_ms": 40048.756, "sample_time_ms": 34841.063, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 5202.108, "learn_throughput": 98.422, "synch_weights_time_ms": 5.18}, "counters": {"num_env_steps_sampled": 2560, "num_env_steps_trained": 2560, "num_agent_steps_sampled": 40960, "num_agent_steps_trained": 40960}, "done": false, "episodes_total": 0, "training_iteration": 5, "trial_id": "0eff4_00000", "date": "2023-05-29_12-18-36", "timestamp": 1685359116, "time_this_iter_s": 43.194552421569824, "time_total_s": 200.25988602638245, "pid": 19016, "hostname": "JM-M16", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "grid4x4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 2e-05, "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.4, vf_clip_param=10.0, entropy_coeff=0.1, vf_loss_coeff=0.25, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 23423, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001BE3549C550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 200.25988602638245, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 2.069642857142857, "ram_util_percent": 44.85178571428571, "gpu_util_percent0": 0.3489285714285714, "vram_util_percent0": 0.00567626953125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5730036763125099, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": 2.237844164390117, "policy_loss": -0.0020048645441420377, "vf_loss": 9.779118737205863, "vf_explained_var": -7.035257294774055e-05, "kl": 0.007696110487813712, "entropy": 2.053154577314854, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7040.5, "diff_num_grad_updates_vs_sampler_policy": 639.5}}, "num_env_steps_sampled": 3072, "num_env_steps_trained": 3072, "num_agent_steps_sampled": 49152, "num_agent_steps_trained": 49152}, "sampler_results": {"episode_reward_max": -156532.1390244883, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -158178.16957495513, "episode_len_mean": 720.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883], "episode_lengths": [720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5114802216677425, "mean_inference_ms": 1.2204805958255525, "mean_action_processing_ms": 0.9203043963726227, "mean_env_wait_ms": 263.96795762375825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00909566879272461, "StateBufferConnector_ms": 0.03768205642700195, "ViewRequirementAgentConnector_ms": 1.2169957160949707}}, "episode_reward_max": -156532.1390244883, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -158178.16957495513, "episode_len_mean": 720.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883], "episode_lengths": [720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5114802216677425, "mean_inference_ms": 1.2204805958255525, "mean_action_processing_ms": 0.9203043963726227, "mean_env_wait_ms": 263.96795762375825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00909566879272461, "StateBufferConnector_ms": 0.03768205642700195, "ViewRequirementAgentConnector_ms": 1.2169957160949707}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 49152, "num_agent_steps_trained": 49152, "num_env_steps_sampled": 3072, "num_env_steps_trained": 3072, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "timesteps_total": 3072, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 49152, "timers": {"training_iteration_time_ms": 40124.174, "sample_time_ms": 34799.842, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 5318.809, "learn_throughput": 96.262, "synch_weights_time_ms": 4.853}, "counters": {"num_env_steps_sampled": 3072, "num_env_steps_trained": 3072, "num_agent_steps_sampled": 49152, "num_agent_steps_trained": 49152}, "done": false, "episodes_total": 4, "training_iteration": 6, "trial_id": "0eff4_00000", "date": "2023-05-29_12-19-16", "timestamp": 1685359156, "time_this_iter_s": 40.50370907783508, "time_total_s": 240.76359510421753, "pid": 19016, "hostname": "JM-M16", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "grid4x4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 2e-05, "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.4, vf_clip_param=10.0, entropy_coeff=0.1, vf_loss_coeff=0.25, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 23423, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001BE3549C550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 240.76359510421753, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 4.820754716981132, "ram_util_percent": 44.92264150943398, "gpu_util_percent0": 0.34264150943396227, "vram_util_percent0": 0.00567626953125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5077590484637767, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": 2.2664943247102203, "policy_loss": -0.00330461435005418, "vf_loss": 9.899606347829103, "vf_explained_var": -4.237517714500427e-09, "kl": 0.008079581038327888, "entropy": 2.0550662856549025, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8320.5, "diff_num_grad_updates_vs_sampler_policy": 639.5}}, "num_env_steps_sampled": 3584, "num_env_steps_trained": 3584, "num_agent_steps_sampled": 57344, "num_agent_steps_trained": 57344}, "sampler_results": {"episode_reward_max": -156532.1390244883, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -158178.16957495513, "episode_len_mean": 720.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883], "episode_lengths": [720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5114802216677425, "mean_inference_ms": 1.2204805958255525, "mean_action_processing_ms": 0.9203043963726227, "mean_env_wait_ms": 263.96795762375825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00909566879272461, "StateBufferConnector_ms": 0.03768205642700195, "ViewRequirementAgentConnector_ms": 1.2169957160949707}}, "episode_reward_max": -156532.1390244883, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -158178.16957495513, "episode_len_mean": 720.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883], "episode_lengths": [720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5114802216677425, "mean_inference_ms": 1.2204805958255525, "mean_action_processing_ms": 0.9203043963726227, "mean_env_wait_ms": 263.96795762375825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00909566879272461, "StateBufferConnector_ms": 0.03768205642700195, "ViewRequirementAgentConnector_ms": 1.2169957160949707}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 57344, "num_agent_steps_trained": 57344, "num_env_steps_sampled": 3584, "num_env_steps_trained": 3584, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "timesteps_total": 3584, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 57344, "timers": {"training_iteration_time_ms": 40179.379, "sample_time_ms": 34787.44, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 5386.56, "learn_throughput": 95.051, "synch_weights_time_ms": 4.805}, "counters": {"num_env_steps_sampled": 3584, "num_env_steps_trained": 3584, "num_agent_steps_sampled": 57344, "num_agent_steps_trained": 57344}, "done": false, "episodes_total": 4, "training_iteration": 7, "trial_id": "0eff4_00000", "date": "2023-05-29_12-19-57", "timestamp": 1685359197, "time_this_iter_s": 40.51361966133118, "time_total_s": 281.2772147655487, "pid": 19016, "hostname": "JM-M16", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "grid4x4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 2e-05, "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.4, vf_clip_param=10.0, entropy_coeff=0.1, vf_loss_coeff=0.25, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 23423, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001BE3549C550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 281.2772147655487, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 4.5903846153846155, "ram_util_percent": 44.92884615384616, "gpu_util_percent0": 0.34403846153846157, "vram_util_percent0": 0.00567626953125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5596048015751875, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": 2.2807125243358315, "policy_loss": -0.004263134555731085, "vf_loss": 9.952694925665856, "vf_explained_var": -9.033828973770141e-09, "kl": 0.011907701115706004, "entropy": 2.0379346517845986, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9600.5, "diff_num_grad_updates_vs_sampler_policy": 639.5}}, "num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_agent_steps_sampled": 65536, "num_agent_steps_trained": 65536}, "sampler_results": {"episode_reward_max": -156532.1390244883, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -158178.16957495513, "episode_len_mean": 720.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883], "episode_lengths": [720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5114802216677425, "mean_inference_ms": 1.2204805958255525, "mean_action_processing_ms": 0.9203043963726227, "mean_env_wait_ms": 263.96795762375825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00909566879272461, "StateBufferConnector_ms": 0.03768205642700195, "ViewRequirementAgentConnector_ms": 1.2169957160949707}}, "episode_reward_max": -156532.1390244883, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -158178.16957495513, "episode_len_mean": 720.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883], "episode_lengths": [720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5114802216677425, "mean_inference_ms": 1.2204805958255525, "mean_action_processing_ms": 0.9203043963726227, "mean_env_wait_ms": 263.96795762375825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00909566879272461, "StateBufferConnector_ms": 0.03768205642700195, "ViewRequirementAgentConnector_ms": 1.2169957160949707}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 65536, "num_agent_steps_trained": 65536, "num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "timesteps_total": 4096, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 65536, "timers": {"training_iteration_time_ms": 40687.965, "sample_time_ms": 35231.177, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 5451.392, "learn_throughput": 93.921, "synch_weights_time_ms": 4.642}, "counters": {"num_env_steps_sampled": 4096, "num_env_steps_trained": 4096, "num_agent_steps_sampled": 65536, "num_agent_steps_trained": 65536}, "done": false, "episodes_total": 4, "training_iteration": 8, "trial_id": "0eff4_00000", "date": "2023-05-29_12-20-41", "timestamp": 1685359241, "time_this_iter_s": 44.252066135406494, "time_total_s": 325.5292809009552, "pid": 19016, "hostname": "JM-M16", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "grid4x4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 2e-05, "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.4, vf_clip_param=10.0, entropy_coeff=0.1, vf_loss_coeff=0.25, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 23423, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001BE3549C550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 325.5292809009552, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 1.5327586206896553, "ram_util_percent": 45.060344827586206, "gpu_util_percent0": 0.34362068965517234, "vram_util_percent0": 0.00567626953125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5728394520992879, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": 2.2877890065312387, "policy_loss": -0.008442297943838639, "vf_loss": 9.992772809416056, "vf_explained_var": -1.0197982192039489e-08, "kl": 0.016499461175408216, "entropy": 2.027868621610105, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10880.5, "diff_num_grad_updates_vs_sampler_policy": 639.5}}, "num_env_steps_sampled": 4608, "num_env_steps_trained": 4608, "num_agent_steps_sampled": 73728, "num_agent_steps_trained": 73728}, "sampler_results": {"episode_reward_max": -156532.1390244883, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -158178.16957495513, "episode_len_mean": 720.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883], "episode_lengths": [720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5114802216677425, "mean_inference_ms": 1.2204805958255525, "mean_action_processing_ms": 0.9203043963726227, "mean_env_wait_ms": 263.96795762375825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00909566879272461, "StateBufferConnector_ms": 0.03768205642700195, "ViewRequirementAgentConnector_ms": 1.2169957160949707}}, "episode_reward_max": -156532.1390244883, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -158178.16957495513, "episode_len_mean": 720.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883], "episode_lengths": [720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5114802216677425, "mean_inference_ms": 1.2204805958255525, "mean_action_processing_ms": 0.9203043963726227, "mean_env_wait_ms": 263.96795762375825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00909566879272461, "StateBufferConnector_ms": 0.03768205642700195, "ViewRequirementAgentConnector_ms": 1.2169957160949707}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 73728, "num_agent_steps_trained": 73728, "num_env_steps_sampled": 4608, "num_env_steps_trained": 4608, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "timesteps_total": 4608, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 73728, "timers": {"training_iteration_time_ms": 41887.458, "sample_time_ms": 36414.88, "load_time_ms": 0.0, "load_throughput": 0.0, "learn_time_ms": 5467.317, "learn_throughput": 93.647, "synch_weights_time_ms": 4.591}, "counters": {"num_env_steps_sampled": 4608, "num_env_steps_trained": 4608, "num_agent_steps_sampled": 73728, "num_agent_steps_trained": 73728}, "done": false, "episodes_total": 4, "training_iteration": 9, "trial_id": "0eff4_00000", "date": "2023-05-29_12-21-33", "timestamp": 1685359293, "time_this_iter_s": 51.48748779296875, "time_total_s": 377.01676869392395, "pid": 19016, "hostname": "JM-M16", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "grid4x4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 2e-05, "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.4, vf_clip_param=10.0, entropy_coeff=0.1, vf_loss_coeff=0.25, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 23423, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001BE3549C550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 377.01676869392395, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 1.495522388059701, "ram_util_percent": 44.1134328358209, "gpu_util_percent0": 0.3452238805970149, "vram_util_percent0": 0.00567626953125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5917511078412645, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": 2.279488465655595, "policy_loss": -0.002365945640485734, "vf_loss": 9.937262623012066, "vf_explained_var": -6.51925802230835e-09, "kl": 0.01155542096712452, "entropy": 2.0303902024403215, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12160.5, "diff_num_grad_updates_vs_sampler_policy": 639.5}}, "num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_agent_steps_sampled": 81920, "num_agent_steps_trained": 81920}, "sampler_results": {"episode_reward_max": -156532.1390244883, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -158178.16957495513, "episode_len_mean": 720.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883], "episode_lengths": [720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5114802216677425, "mean_inference_ms": 1.2204805958255525, "mean_action_processing_ms": 0.9203043963726227, "mean_env_wait_ms": 263.96795762375825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00909566879272461, "StateBufferConnector_ms": 0.03768205642700195, "ViewRequirementAgentConnector_ms": 1.2169957160949707}}, "episode_reward_max": -156532.1390244883, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -158178.16957495513, "episode_len_mean": 720.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883], "episode_lengths": [720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5114802216677425, "mean_inference_ms": 1.2204805958255525, "mean_action_processing_ms": 0.9203043963726227, "mean_env_wait_ms": 263.96795762375825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00909566879272461, "StateBufferConnector_ms": 0.03768205642700195, "ViewRequirementAgentConnector_ms": 1.2169957160949707}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 81920, "num_agent_steps_trained": 81920, "num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "timesteps_total": 5120, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 81920, "timers": {"training_iteration_time_ms": 42964.275, "sample_time_ms": 37540.62, "load_time_ms": 0.1, "load_throughput": 5125259.303, "learn_time_ms": 5418.42, "learn_throughput": 94.492, "synch_weights_time_ms": 4.532}, "counters": {"num_env_steps_sampled": 5120, "num_env_steps_trained": 5120, "num_agent_steps_sampled": 81920, "num_agent_steps_trained": 81920}, "done": false, "episodes_total": 4, "training_iteration": 10, "trial_id": "0eff4_00000", "date": "2023-05-29_12-22-25", "timestamp": 1685359345, "time_this_iter_s": 52.6596257686615, "time_total_s": 429.67639446258545, "pid": 19016, "hostname": "JM-M16", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "grid4x4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 2e-05, "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.4, vf_clip_param=10.0, entropy_coeff=0.1, vf_loss_coeff=0.25, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 23423, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001BE3549C550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 429.67639446258545, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 7.562790697674417, "ram_util_percent": 43.65581395348837, "gpu_util_percent0": 0.015813953488372095, "vram_util_percent0": 0.00039601880450581395}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6227494932711124, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": 2.265398907288909, "policy_loss": -0.006946240150136873, "vf_loss": 9.900477169454097, "vf_explained_var": -1.103617250919342e-08, "kl": 0.011845468296087347, "entropy": 2.033664112072438, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13440.5, "diff_num_grad_updates_vs_sampler_policy": 639.5}}, "num_env_steps_sampled": 5632, "num_env_steps_trained": 5632, "num_agent_steps_sampled": 90112, "num_agent_steps_trained": 90112}, "sampler_results": {"episode_reward_max": -156532.1390244883, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -158178.16957495513, "episode_len_mean": 720.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883], "episode_lengths": [720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5114802216677425, "mean_inference_ms": 1.2204805958255525, "mean_action_processing_ms": 0.9203043963726227, "mean_env_wait_ms": 263.96795762375825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00909566879272461, "StateBufferConnector_ms": 0.03768205642700195, "ViewRequirementAgentConnector_ms": 1.2169957160949707}}, "episode_reward_max": -156532.1390244883, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -158178.16957495513, "episode_len_mean": 720.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883], "episode_lengths": [720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5114802216677425, "mean_inference_ms": 1.2204805958255525, "mean_action_processing_ms": 0.9203043963726227, "mean_env_wait_ms": 263.96795762375825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00909566879272461, "StateBufferConnector_ms": 0.03768205642700195, "ViewRequirementAgentConnector_ms": 1.2169957160949707}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 90112, "num_agent_steps_trained": 90112, "num_env_steps_sampled": 5632, "num_env_steps_trained": 5632, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "timesteps_total": 5632, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 90112, "timers": {"training_iteration_time_ms": 42776.793, "sample_time_ms": 37372.067, "load_time_ms": 0.197, "load_throughput": 2597029.445, "learn_time_ms": 5399.385, "learn_throughput": 94.826, "synch_weights_time_ms": 4.54}, "counters": {"num_env_steps_sampled": 5632, "num_env_steps_trained": 5632, "num_agent_steps_sampled": 90112, "num_agent_steps_trained": 90112}, "done": false, "episodes_total": 4, "training_iteration": 11, "trial_id": "0eff4_00000", "date": "2023-05-29_12-22-58", "timestamp": 1685359378, "time_this_iter_s": 32.604859828948975, "time_total_s": 462.2812542915344, "pid": 19016, "hostname": "JM-M16", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "grid4x4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 2e-05, "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.4, vf_clip_param=10.0, entropy_coeff=0.1, vf_loss_coeff=0.25, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 23423, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001BE3549C550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 462.2812542915344, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 5.41590909090909, "ram_util_percent": 43.50454545454546, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5787140843924135, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": 2.245448002498597, "policy_loss": -0.0034751448569295463, "vf_loss": 9.810829102620483, "vf_explained_var": -0.000549798971042037, "kl": 0.01414660384216404, "entropy": 2.044914529286325, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14720.5, "diff_num_grad_updates_vs_sampler_policy": 639.5}}, "num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_agent_steps_sampled": 98304, "num_agent_steps_trained": 98304}, "sampler_results": {"episode_reward_max": -155535.38123424863, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -157110.4485077978, "episode_len_mean": 720.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5387899852729987, "mean_inference_ms": 1.2382782687094593, "mean_action_processing_ms": 0.9625603306959786, "mean_env_wait_ms": 268.2144088789688, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004547834396362305, "StateBufferConnector_ms": 0.03133416175842285, "ViewRequirementAgentConnector_ms": 1.0998964309692383}}, "episode_reward_max": -155535.38123424863, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -157110.4485077978, "episode_len_mean": 720.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5387899852729987, "mean_inference_ms": 1.2382782687094593, "mean_action_processing_ms": 0.9625603306959786, "mean_env_wait_ms": 268.2144088789688, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004547834396362305, "StateBufferConnector_ms": 0.03133416175842285, "ViewRequirementAgentConnector_ms": 1.0998964309692383}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 98304, "num_agent_steps_trained": 98304, "num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "timesteps_total": 6144, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 98304, "timers": {"training_iteration_time_ms": 42505.024, "sample_time_ms": 37096.982, "load_time_ms": 0.197, "load_throughput": 2597029.445, "learn_time_ms": 5402.984, "learn_throughput": 94.762, "synch_weights_time_ms": 4.258}, "counters": {"num_env_steps_sampled": 6144, "num_env_steps_trained": 6144, "num_agent_steps_sampled": 98304, "num_agent_steps_trained": 98304}, "done": false, "episodes_total": 8, "training_iteration": 12, "trial_id": "0eff4_00000", "date": "2023-05-29_12-23-31", "timestamp": 1685359411, "time_this_iter_s": 32.51463079452515, "time_total_s": 494.79588508605957, "pid": 19016, "hostname": "JM-M16", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "grid4x4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 2e-05, "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.4, vf_clip_param=10.0, entropy_coeff=0.1, vf_loss_coeff=0.25, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 23423, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001BE3549C550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 494.79588508605957, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 5.318604651162791, "ram_util_percent": 43.430232558139544, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5630499759921804, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": 2.2716157705523075, "policy_loss": -0.005086199766810751, "vf_loss": 9.922940423339606, "vf_explained_var": -8.940696716308593e-09, "kl": 0.011735234522348037, "entropy": 2.0461989367380737, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16000.5, "diff_num_grad_updates_vs_sampler_policy": 639.5}}, "num_env_steps_sampled": 6656, "num_env_steps_trained": 6656, "num_agent_steps_sampled": 106496, "num_agent_steps_trained": 106496}, "sampler_results": {"episode_reward_max": -155535.38123424863, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -157110.4485077978, "episode_len_mean": 720.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5387899852729987, "mean_inference_ms": 1.2382782687094593, "mean_action_processing_ms": 0.9625603306959786, "mean_env_wait_ms": 268.2144088789688, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004547834396362305, "StateBufferConnector_ms": 0.03133416175842285, "ViewRequirementAgentConnector_ms": 1.0998964309692383}}, "episode_reward_max": -155535.38123424863, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -157110.4485077978, "episode_len_mean": 720.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5387899852729987, "mean_inference_ms": 1.2382782687094593, "mean_action_processing_ms": 0.9625603306959786, "mean_env_wait_ms": 268.2144088789688, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004547834396362305, "StateBufferConnector_ms": 0.03133416175842285, "ViewRequirementAgentConnector_ms": 1.0998964309692383}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 106496, "num_agent_steps_trained": 106496, "num_env_steps_sampled": 6656, "num_env_steps_trained": 6656, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "timesteps_total": 6656, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 106496, "timers": {"training_iteration_time_ms": 41788.89, "sample_time_ms": 36209.441, "load_time_ms": 0.297, "load_throughput": 1723778.815, "learn_time_ms": 5574.717, "learn_throughput": 91.843, "synch_weights_time_ms": 3.832}, "counters": {"num_env_steps_sampled": 6656, "num_env_steps_trained": 6656, "num_agent_steps_sampled": 106496, "num_agent_steps_trained": 106496}, "done": false, "episodes_total": 8, "training_iteration": 13, "trial_id": "0eff4_00000", "date": "2023-05-29_12-24-06", "timestamp": 1685359446, "time_this_iter_s": 35.28894662857056, "time_total_s": 530.0848317146301, "pid": 19016, "hostname": "JM-M16", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "grid4x4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 2e-05, "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.4, vf_clip_param=10.0, entropy_coeff=0.1, vf_loss_coeff=0.25, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 23423, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001BE3549C550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 530.0848317146301, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 5.327659574468086, "ram_util_percent": 43.80212765957447, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5522541111684405, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": 2.282191607449204, "policy_loss": -0.008403512209770269, "vf_loss": 9.976963681727648, "vf_explained_var": -6.05359673500061e-09, "kl": 0.01504200122653856, "entropy": 2.0439789801836015, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17280.5, "diff_num_grad_updates_vs_sampler_policy": 639.5}}, "num_env_steps_sampled": 7168, "num_env_steps_trained": 7168, "num_agent_steps_sampled": 114688, "num_agent_steps_trained": 114688}, "sampler_results": {"episode_reward_max": -155535.38123424863, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -157110.4485077978, "episode_len_mean": 720.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5387899852729987, "mean_inference_ms": 1.2382782687094593, "mean_action_processing_ms": 0.9625603306959786, "mean_env_wait_ms": 268.2144088789688, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004547834396362305, "StateBufferConnector_ms": 0.03133416175842285, "ViewRequirementAgentConnector_ms": 1.0998964309692383}}, "episode_reward_max": -155535.38123424863, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -157110.4485077978, "episode_len_mean": 720.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5387899852729987, "mean_inference_ms": 1.2382782687094593, "mean_action_processing_ms": 0.9625603306959786, "mean_env_wait_ms": 268.2144088789688, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004547834396362305, "StateBufferConnector_ms": 0.03133416175842285, "ViewRequirementAgentConnector_ms": 1.0998964309692383}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 114688, "num_agent_steps_trained": 114688, "num_env_steps_sampled": 7168, "num_env_steps_trained": 7168, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "timesteps_total": 7168, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 114688, "timers": {"training_iteration_time_ms": 41240.275, "sample_time_ms": 35632.799, "load_time_ms": 0.297, "load_throughput": 1723778.815, "learn_time_ms": 5602.848, "learn_throughput": 91.382, "synch_weights_time_ms": 3.832}, "counters": {"num_env_steps_sampled": 7168, "num_env_steps_trained": 7168, "num_agent_steps_sampled": 114688, "num_agent_steps_trained": 114688}, "done": false, "episodes_total": 8, "training_iteration": 14, "trial_id": "0eff4_00000", "date": "2023-05-29_12-24-45", "timestamp": 1685359485, "time_this_iter_s": 39.41609477996826, "time_total_s": 569.5009264945984, "pid": 19016, "hostname": "JM-M16", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "grid4x4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 2e-05, "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.4, vf_clip_param=10.0, entropy_coeff=0.1, vf_loss_coeff=0.25, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 23423, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001BE3549C550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 569.5009264945984, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 4.351923076923077, "ram_util_percent": 45.31923076923077, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6082209262647666, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": 2.2816386566497386, "policy_loss": -0.008408936035630176, "vf_loss": 9.972529429197312, "vf_explained_var": -1.0849907994270325e-08, "kl": 0.014587460193433799, "entropy": 2.038141407072544, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18560.5, "diff_num_grad_updates_vs_sampler_policy": 639.5}}, "num_env_steps_sampled": 7680, "num_env_steps_trained": 7680, "num_agent_steps_sampled": 122880, "num_agent_steps_trained": 122880}, "sampler_results": {"episode_reward_max": -155535.38123424863, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -157110.4485077978, "episode_len_mean": 720.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5387899852729987, "mean_inference_ms": 1.2382782687094593, "mean_action_processing_ms": 0.9625603306959786, "mean_env_wait_ms": 268.2144088789688, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004547834396362305, "StateBufferConnector_ms": 0.03133416175842285, "ViewRequirementAgentConnector_ms": 1.0998964309692383}}, "episode_reward_max": -155535.38123424863, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -157110.4485077978, "episode_len_mean": 720.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5387899852729987, "mean_inference_ms": 1.2382782687094593, "mean_action_processing_ms": 0.9625603306959786, "mean_env_wait_ms": 268.2144088789688, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004547834396362305, "StateBufferConnector_ms": 0.03133416175842285, "ViewRequirementAgentConnector_ms": 1.0998964309692383}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 122880, "num_agent_steps_trained": 122880, "num_env_steps_sampled": 7680, "num_env_steps_trained": 7680, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "timesteps_total": 7680, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 122880, "timers": {"training_iteration_time_ms": 44179.341, "sample_time_ms": 37962.898, "load_time_ms": 0.297, "load_throughput": 1723778.815, "learn_time_ms": 6212.367, "learn_throughput": 82.416, "synch_weights_time_ms": 3.28}, "counters": {"num_env_steps_sampled": 7680, "num_env_steps_trained": 7680, "num_agent_steps_sampled": 122880, "num_agent_steps_trained": 122880}, "done": false, "episodes_total": 8, "training_iteration": 15, "trial_id": "0eff4_00000", "date": "2023-05-29_12-25-58", "timestamp": 1685359558, "time_this_iter_s": 72.59584450721741, "time_total_s": 642.0967710018158, "pid": 19016, "hostname": "JM-M16", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "grid4x4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 2e-05, "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.4, vf_clip_param=10.0, entropy_coeff=0.1, vf_loss_coeff=0.25, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 23423, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001BE3549C550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 642.0967710018158, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 6.881052631578945, "ram_util_percent": 42.897894736842105, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5779568037949503, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": 2.276599331013858, "policy_loss": -0.006641713323188014, "vf_loss": 9.944418210536242, "vf_explained_var": -7.59027898311615e-09, "kl": 0.014733359635647503, "entropy": 2.036001798324287, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19840.5, "diff_num_grad_updates_vs_sampler_policy": 639.5}}, "num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_agent_steps_sampled": 131072, "num_agent_steps_trained": 131072}, "sampler_results": {"episode_reward_max": -155535.38123424863, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -157110.4485077978, "episode_len_mean": 720.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5387899852729987, "mean_inference_ms": 1.2382782687094593, "mean_action_processing_ms": 0.9625603306959786, "mean_env_wait_ms": 268.2144088789688, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004547834396362305, "StateBufferConnector_ms": 0.03133416175842285, "ViewRequirementAgentConnector_ms": 1.0998964309692383}}, "episode_reward_max": -155535.38123424863, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -157110.4485077978, "episode_len_mean": 720.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5387899852729987, "mean_inference_ms": 1.2382782687094593, "mean_action_processing_ms": 0.9625603306959786, "mean_env_wait_ms": 268.2144088789688, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004547834396362305, "StateBufferConnector_ms": 0.03133416175842285, "ViewRequirementAgentConnector_ms": 1.0998964309692383}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 131072, "num_agent_steps_trained": 131072, "num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "timesteps_total": 8192, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 131072, "timers": {"training_iteration_time_ms": 44254.2, "sample_time_ms": 38154.481, "load_time_ms": 0.297, "load_throughput": 1723778.815, "learn_time_ms": 6095.664, "learn_throughput": 83.994, "synch_weights_time_ms": 3.258}, "counters": {"num_env_steps_sampled": 8192, "num_env_steps_trained": 8192, "num_agent_steps_sampled": 131072, "num_agent_steps_trained": 131072}, "done": false, "episodes_total": 8, "training_iteration": 16, "trial_id": "0eff4_00000", "date": "2023-05-29_12-26-39", "timestamp": 1685359599, "time_this_iter_s": 41.25284719467163, "time_total_s": 683.3496181964874, "pid": 19016, "hostname": "JM-M16", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "grid4x4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 2e-05, "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.4, vf_clip_param=10.0, entropy_coeff=0.1, vf_loss_coeff=0.25, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 23423, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001BE3549C550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 683.3496181964874, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 4.63148148148148, "ram_util_percent": 42.851851851851876, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.808117424219381, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": 2.1394336826881046, "policy_loss": -0.006074675629679405, "vf_loss": 9.39463804103434, "vf_explained_var": -0.0021967294625937937, "kl": 0.012687910737440689, "entropy": 2.03785551302135, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21120.5, "diff_num_grad_updates_vs_sampler_policy": 639.5}}, "num_env_steps_sampled": 8704, "num_env_steps_trained": 8704, "num_agent_steps_sampled": 139264, "num_agent_steps_trained": 139264}, "sampler_results": {"episode_reward_max": -155535.38123424863, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -157330.9042479523, "episode_len_mean": 720.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.600444024970463, "mean_inference_ms": 1.254178412005989, "mean_action_processing_ms": 0.9714137534801269, "mean_env_wait_ms": 270.5462364212765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019884109497070312, "StateBufferConnector_ms": 0.020889441172281902, "ViewRequirementAgentConnector_ms": 0.9583195050557455}}, "episode_reward_max": -155535.38123424863, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -157330.9042479523, "episode_len_mean": 720.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.600444024970463, "mean_inference_ms": 1.254178412005989, "mean_action_processing_ms": 0.9714137534801269, "mean_env_wait_ms": 270.5462364212765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019884109497070312, "StateBufferConnector_ms": 0.020889441172281902, "ViewRequirementAgentConnector_ms": 0.9583195050557455}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 139264, "num_agent_steps_trained": 139264, "num_env_steps_sampled": 8704, "num_env_steps_trained": 8704, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "timesteps_total": 8704, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 139264, "timers": {"training_iteration_time_ms": 43288.644, "sample_time_ms": 37279.892, "load_time_ms": 0.297, "load_throughput": 1723778.815, "learn_time_ms": 6004.749, "learn_throughput": 85.266, "synch_weights_time_ms": 3.207}, "counters": {"num_env_steps_sampled": 8704, "num_env_steps_trained": 8704, "num_agent_steps_sampled": 139264, "num_agent_steps_trained": 139264}, "done": false, "episodes_total": 12, "training_iteration": 17, "trial_id": "0eff4_00000", "date": "2023-05-29_12-27-10", "timestamp": 1685359630, "time_this_iter_s": 30.859055995941162, "time_total_s": 714.2086741924286, "pid": 19016, "hostname": "JM-M16", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "grid4x4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 2e-05, "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.4, vf_clip_param=10.0, entropy_coeff=0.1, vf_loss_coeff=0.25, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 23423, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001BE3549C550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 714.2086741924286, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 3.892682926829268, "ram_util_percent": 42.86585365853658, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5775335391866975, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": 2.2672809129580855, "policy_loss": -0.006312415915454039, "vf_loss": 9.909252264350652, "vf_explained_var": -1.6298145055770874e-09, "kl": 0.012865394226173521, "entropy": 2.043630074895918, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22400.5, "diff_num_grad_updates_vs_sampler_policy": 639.5}}, "num_env_steps_sampled": 9216, "num_env_steps_trained": 9216, "num_agent_steps_sampled": 147456, "num_agent_steps_trained": 147456}, "sampler_results": {"episode_reward_max": -155535.38123424863, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -157330.9042479523, "episode_len_mean": 720.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.600444024970463, "mean_inference_ms": 1.254178412005989, "mean_action_processing_ms": 0.9714137534801269, "mean_env_wait_ms": 270.5462364212765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019884109497070312, "StateBufferConnector_ms": 0.020889441172281902, "ViewRequirementAgentConnector_ms": 0.9583195050557455}}, "episode_reward_max": -155535.38123424863, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -157330.9042479523, "episode_len_mean": 720.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.600444024970463, "mean_inference_ms": 1.254178412005989, "mean_action_processing_ms": 0.9714137534801269, "mean_env_wait_ms": 270.5462364212765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019884109497070312, "StateBufferConnector_ms": 0.020889441172281902, "ViewRequirementAgentConnector_ms": 0.9583195050557455}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 147456, "num_agent_steps_trained": 147456, "num_env_steps_sampled": 9216, "num_env_steps_trained": 9216, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "timesteps_total": 9216, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 147456, "timers": {"training_iteration_time_ms": 41887.295, "sample_time_ms": 35997.159, "load_time_ms": 0.297, "load_throughput": 1723778.815, "learn_time_ms": 5886.291, "learn_throughput": 86.982, "synch_weights_time_ms": 3.153}, "counters": {"num_env_steps_sampled": 9216, "num_env_steps_trained": 9216, "num_agent_steps_sampled": 147456, "num_agent_steps_trained": 147456}, "done": false, "episodes_total": 12, "training_iteration": 18, "trial_id": "0eff4_00000", "date": "2023-05-29_12-27-40", "timestamp": 1685359660, "time_this_iter_s": 30.239573001861572, "time_total_s": 744.4482471942902, "pid": 19016, "hostname": "JM-M16", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "grid4x4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 2e-05, "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.4, vf_clip_param=10.0, entropy_coeff=0.1, vf_loss_coeff=0.25, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 23423, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001BE3549C550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 744.4482471942902, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 3.6450000000000005, "ram_util_percent": 42.847500000000004, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5350251085590572, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": 2.2761964998207986, "policy_loss": -0.010114770302607212, "vf_loss": 9.958367502689361, "vf_explained_var": -9.35979187488556e-09, "kl": 0.01592073018218798, "entropy": 2.0407664511352777, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23680.5, "diff_num_grad_updates_vs_sampler_policy": 639.5}}, "num_env_steps_sampled": 9728, "num_env_steps_trained": 9728, "num_agent_steps_sampled": 155648, "num_agent_steps_trained": 155648}, "sampler_results": {"episode_reward_max": -155535.38123424863, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -157330.9042479523, "episode_len_mean": 720.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.600444024970463, "mean_inference_ms": 1.254178412005989, "mean_action_processing_ms": 0.9714137534801269, "mean_env_wait_ms": 270.5462364212765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019884109497070312, "StateBufferConnector_ms": 0.020889441172281902, "ViewRequirementAgentConnector_ms": 0.9583195050557455}}, "episode_reward_max": -155535.38123424863, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -157330.9042479523, "episode_len_mean": 720.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.600444024970463, "mean_inference_ms": 1.254178412005989, "mean_action_processing_ms": 0.9714137534801269, "mean_env_wait_ms": 270.5462364212765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019884109497070312, "StateBufferConnector_ms": 0.020889441172281902, "ViewRequirementAgentConnector_ms": 0.9583195050557455}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 155648, "num_agent_steps_trained": 155648, "num_env_steps_sampled": 9728, "num_env_steps_trained": 9728, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "timesteps_total": 9728, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 155648, "timers": {"training_iteration_time_ms": 39941.003, "sample_time_ms": 34135.368, "load_time_ms": 0.397, "load_throughput": 1289160.552, "learn_time_ms": 5801.765, "learn_throughput": 88.249, "synch_weights_time_ms": 3.078}, "counters": {"num_env_steps_sampled": 9728, "num_env_steps_trained": 9728, "num_agent_steps_sampled": 155648, "num_agent_steps_trained": 155648}, "done": false, "episodes_total": 12, "training_iteration": 19, "trial_id": "0eff4_00000", "date": "2023-05-29_12-28-13", "timestamp": 1685359693, "time_this_iter_s": 32.02648997306824, "time_total_s": 776.4747371673584, "pid": 19016, "hostname": "JM-M16", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "grid4x4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 2e-05, "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.4, vf_clip_param=10.0, entropy_coeff=0.1, vf_loss_coeff=0.25, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 23423, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001BE3549C550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 776.4747371673584, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 4.6976744186046515, "ram_util_percent": 42.930232558139544, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5707139004720375, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": 2.286802342813462, "policy_loss": -0.006614466693281429, "vf_loss": 9.985991387814284, "vf_explained_var": -1.0896474123001098e-08, "kl": 0.01627629939612234, "entropy": 2.038948513753712, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24960.5, "diff_num_grad_updates_vs_sampler_policy": 639.5}}, "num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_agent_steps_sampled": 163840, "num_agent_steps_trained": 163840}, "sampler_results": {"episode_reward_max": -155535.38123424863, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -157330.9042479523, "episode_len_mean": 720.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.600444024970463, "mean_inference_ms": 1.254178412005989, "mean_action_processing_ms": 0.9714137534801269, "mean_env_wait_ms": 270.5462364212765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019884109497070312, "StateBufferConnector_ms": 0.020889441172281902, "ViewRequirementAgentConnector_ms": 0.9583195050557455}}, "episode_reward_max": -155535.38123424863, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -157330.9042479523, "episode_len_mean": 720.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.600444024970463, "mean_inference_ms": 1.254178412005989, "mean_action_processing_ms": 0.9714137534801269, "mean_env_wait_ms": 270.5462364212765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019884109497070312, "StateBufferConnector_ms": 0.020889441172281902, "ViewRequirementAgentConnector_ms": 0.9583195050557455}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 163840, "num_agent_steps_trained": 163840, "num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "timesteps_total": 10240, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 163840, "timers": {"training_iteration_time_ms": 38498.52, "sample_time_ms": 32684.968, "load_time_ms": 0.297, "load_throughput": 1722396.253, "learn_time_ms": 5809.851, "learn_throughput": 88.126, "synch_weights_time_ms": 3.009}, "counters": {"num_env_steps_sampled": 10240, "num_env_steps_trained": 10240, "num_agent_steps_sampled": 163840, "num_agent_steps_trained": 163840}, "done": false, "episodes_total": 12, "training_iteration": 20, "trial_id": "0eff4_00000", "date": "2023-05-29_12-28-51", "timestamp": 1685359731, "time_this_iter_s": 38.23583698272705, "time_total_s": 814.7105741500854, "pid": 19016, "hostname": "JM-M16", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "grid4x4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 2e-05, "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.4, vf_clip_param=10.0, entropy_coeff=0.1, vf_loss_coeff=0.25, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 23423, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001BE3549C550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 814.7105741500854, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 4.798039215686274, "ram_util_percent": 42.9372549019608, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5942423060419969, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": 2.2803358822129667, "policy_loss": -0.00566397442453308, "vf_loss": 9.95909986793995, "vf_explained_var": -5.913898348808288e-09, "kl": 0.012616083851753501, "entropy": 2.04405905790627, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26240.5, "diff_num_grad_updates_vs_sampler_policy": 639.5}}, "num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_agent_steps_sampled": 172032, "num_agent_steps_trained": 172032}, "sampler_results": {"episode_reward_max": -155535.38123424863, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -157330.9042479523, "episode_len_mean": 720.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.600444024970463, "mean_inference_ms": 1.254178412005989, "mean_action_processing_ms": 0.9714137534801269, "mean_env_wait_ms": 270.5462364212765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019884109497070312, "StateBufferConnector_ms": 0.020889441172281902, "ViewRequirementAgentConnector_ms": 0.9583195050557455}}, "episode_reward_max": -155535.38123424863, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -157330.9042479523, "episode_len_mean": 720.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.600444024970463, "mean_inference_ms": 1.254178412005989, "mean_action_processing_ms": 0.9714137534801269, "mean_env_wait_ms": 270.5462364212765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019884109497070312, "StateBufferConnector_ms": 0.020889441172281902, "ViewRequirementAgentConnector_ms": 0.9583195050557455}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172032, "num_agent_steps_trained": 172032, "num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "timesteps_total": 10752, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 172032, "timers": {"training_iteration_time_ms": 38901.937, "sample_time_ms": 33103.097, "load_time_ms": 0.2, "load_throughput": 2559880.377, "learn_time_ms": 5795.237, "learn_throughput": 88.348, "synch_weights_time_ms": 2.908}, "counters": {"num_env_steps_sampled": 10752, "num_env_steps_trained": 10752, "num_agent_steps_sampled": 172032, "num_agent_steps_trained": 172032}, "done": false, "episodes_total": 12, "training_iteration": 21, "trial_id": "0eff4_00000", "date": "2023-05-29_12-29-27", "timestamp": 1685359767, "time_this_iter_s": 36.64202928543091, "time_total_s": 851.3526034355164, "pid": 19016, "hostname": "JM-M16", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "grid4x4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 2e-05, "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.4, vf_clip_param=10.0, entropy_coeff=0.1, vf_loss_coeff=0.25, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 23423, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001BE3549C550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 851.3526034355164, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 2.1142857142857143, "ram_util_percent": 42.29183673469388, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6101495714858174, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": 2.2595240279100834, "policy_loss": -0.0053467344845557815, "vf_loss": 9.86836775764823, "vf_explained_var": -6.752088665962219e-09, "kl": 0.015774077409514576, "entropy": 2.0300988075323403, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27520.5, "diff_num_grad_updates_vs_sampler_policy": 639.5}}, "num_env_steps_sampled": 11264, "num_env_steps_trained": 11264, "num_agent_steps_sampled": 180224, "num_agent_steps_trained": 180224}, "sampler_results": {"episode_reward_max": -155535.38123424863, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -157330.9042479523, "episode_len_mean": 720.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.600444024970463, "mean_inference_ms": 1.254178412005989, "mean_action_processing_ms": 0.9714137534801269, "mean_env_wait_ms": 270.5462364212765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019884109497070312, "StateBufferConnector_ms": 0.020889441172281902, "ViewRequirementAgentConnector_ms": 0.9583195050557455}}, "episode_reward_max": -155535.38123424863, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -157330.9042479523, "episode_len_mean": 720.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.600444024970463, "mean_inference_ms": 1.254178412005989, "mean_action_processing_ms": 0.9714137534801269, "mean_env_wait_ms": 270.5462364212765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019884109497070312, "StateBufferConnector_ms": 0.020889441172281902, "ViewRequirementAgentConnector_ms": 0.9583195050557455}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180224, "num_agent_steps_trained": 180224, "num_env_steps_sampled": 11264, "num_env_steps_trained": 11264, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "timesteps_total": 11264, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 180224, "timers": {"training_iteration_time_ms": 38838.139, "sample_time_ms": 33045.241, "load_time_ms": 0.2, "load_throughput": 2559880.377, "learn_time_ms": 5788.889, "learn_throughput": 88.445, "synch_weights_time_ms": 3.2}, "counters": {"num_env_steps_sampled": 11264, "num_env_steps_trained": 11264, "num_agent_steps_sampled": 180224, "num_agent_steps_trained": 180224}, "done": false, "episodes_total": 12, "training_iteration": 22, "trial_id": "0eff4_00000", "date": "2023-05-29_12-29-59", "timestamp": 1685359799, "time_this_iter_s": 31.879522562026978, "time_total_s": 883.2321259975433, "pid": 19016, "hostname": "JM-M16", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "grid4x4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 2e-05, "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.4, vf_clip_param=10.0, entropy_coeff=0.1, vf_loss_coeff=0.25, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 23423, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001BE3549C550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 883.2321259975433, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 4.6499999999999995, "ram_util_percent": 42.29523809523809, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6030971806263551, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": 2.243767953757197, "policy_loss": -0.004884780015709111, "vf_loss": 9.808515978977084, "vf_explained_var": -7.497146725654603e-09, "kl": 0.013683994795064791, "entropy": 2.0416046029888095, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 28800.5, "diff_num_grad_updates_vs_sampler_policy": 639.5}}, "num_env_steps_sampled": 11776, "num_env_steps_trained": 11776, "num_agent_steps_sampled": 188416, "num_agent_steps_trained": 188416}, "sampler_results": {"episode_reward_max": -155535.38123424863, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -157364.57105358684, "episode_len_mean": 720.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902, -157918.28919593635, -157211.36051161523, -157916.480700045, -156816.1554743655], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.597392576728396, "mean_inference_ms": 1.2507846654823942, "mean_action_processing_ms": 0.962642544988273, "mean_env_wait_ms": 267.9051662502395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021167099475860596, "StateBufferConnector_ms": 0.015667080879211426, "ViewRequirementAgentConnector_ms": 1.0785683989524841}}, "episode_reward_max": -155535.38123424863, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -157364.57105358684, "episode_len_mean": 720.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902, -157918.28919593635, -157211.36051161523, -157916.480700045, -156816.1554743655], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.597392576728396, "mean_inference_ms": 1.2507846654823942, "mean_action_processing_ms": 0.962642544988273, "mean_env_wait_ms": 267.9051662502395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021167099475860596, "StateBufferConnector_ms": 0.015667080879211426, "ViewRequirementAgentConnector_ms": 1.0785683989524841}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188416, "num_agent_steps_trained": 188416, "num_env_steps_sampled": 11776, "num_env_steps_trained": 11776, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "timesteps_total": 11776, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 188416, "timers": {"training_iteration_time_ms": 38497.058, "sample_time_ms": 32885.018, "load_time_ms": 0.1, "load_throughput": 5113056.305, "learn_time_ms": 5608.192, "learn_throughput": 91.295, "synch_weights_time_ms": 3.137}, "counters": {"num_env_steps_sampled": 11776, "num_env_steps_trained": 11776, "num_agent_steps_sampled": 188416, "num_agent_steps_trained": 188416}, "done": false, "episodes_total": 16, "training_iteration": 23, "trial_id": "0eff4_00000", "date": "2023-05-29_12-30-31", "timestamp": 1685359831, "time_this_iter_s": 31.87813425064087, "time_total_s": 915.1102602481842, "pid": 19016, "hostname": "JM-M16", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "grid4x4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 2e-05, "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.4, vf_clip_param=10.0, entropy_coeff=0.1, vf_loss_coeff=0.25, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 23423, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001BE3549C550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 915.1102602481842, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 4.062790697674418, "ram_util_percent": 42.2906976744186, "gpu_util_percent0": 0.0013953488372093023, "vram_util_percent0": 0.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5185878729447723, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": 2.271278812177479, "policy_loss": -0.00740331368506304, "vf_loss": 9.931499853730202, "vf_explained_var": -5.308538675308228e-09, "kl": 0.01283865798941406, "entropy": 2.0483476470224558, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 30080.5, "diff_num_grad_updates_vs_sampler_policy": 639.5}}, "num_env_steps_sampled": 12288, "num_env_steps_trained": 12288, "num_agent_steps_sampled": 196608, "num_agent_steps_trained": 196608}, "sampler_results": {"episode_reward_max": -155535.38123424863, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -157364.57105358684, "episode_len_mean": 720.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902, -157918.28919593635, -157211.36051161523, -157916.480700045, -156816.1554743655], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.597392576728396, "mean_inference_ms": 1.2507846654823942, "mean_action_processing_ms": 0.962642544988273, "mean_env_wait_ms": 267.9051662502395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021167099475860596, "StateBufferConnector_ms": 0.015667080879211426, "ViewRequirementAgentConnector_ms": 1.0785683989524841}}, "episode_reward_max": -155535.38123424863, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -157364.57105358684, "episode_len_mean": 720.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902, -157918.28919593635, -157211.36051161523, -157916.480700045, -156816.1554743655], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.597392576728396, "mean_inference_ms": 1.2507846654823942, "mean_action_processing_ms": 0.962642544988273, "mean_env_wait_ms": 267.9051662502395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021167099475860596, "StateBufferConnector_ms": 0.015667080879211426, "ViewRequirementAgentConnector_ms": 1.0785683989524841}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196608, "num_agent_steps_trained": 196608, "num_env_steps_sampled": 12288, "num_env_steps_trained": 12288, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "timesteps_total": 12288, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 196608, "timers": {"training_iteration_time_ms": 37643.39, "sample_time_ms": 32102.241, "load_time_ms": 0.1, "load_throughput": 5113056.305, "learn_time_ms": 5537.403, "learn_throughput": 92.462, "synch_weights_time_ms": 3.133}, "counters": {"num_env_steps_sampled": 12288, "num_env_steps_trained": 12288, "num_agent_steps_sampled": 196608, "num_agent_steps_trained": 196608}, "done": false, "episodes_total": 16, "training_iteration": 24, "trial_id": "0eff4_00000", "date": "2023-05-29_12-31-02", "timestamp": 1685359862, "time_this_iter_s": 30.878533363342285, "time_total_s": 945.9887936115265, "pid": 19016, "hostname": "JM-M16", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "grid4x4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 2e-05, "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.4, vf_clip_param=10.0, entropy_coeff=0.1, vf_loss_coeff=0.25, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 23423, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001BE3549C550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 945.9887936115265, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 4.539024390243903, "ram_util_percent": 42.3, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.544094886444509, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": 2.2869648059830068, "policy_loss": -0.004186504571407568, "vf_loss": 9.980547687411308, "vf_explained_var": -1.0896474123001098e-08, "kl": 0.015065102845983346, "entropy": 2.047388645913452, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31360.5, "diff_num_grad_updates_vs_sampler_policy": 639.5}}, "num_env_steps_sampled": 12800, "num_env_steps_trained": 12800, "num_agent_steps_sampled": 204800, "num_agent_steps_trained": 204800}, "sampler_results": {"episode_reward_max": -155535.38123424863, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -157364.57105358684, "episode_len_mean": 720.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902, -157918.28919593635, -157211.36051161523, -157916.480700045, -156816.1554743655], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.597392576728396, "mean_inference_ms": 1.2507846654823942, "mean_action_processing_ms": 0.962642544988273, "mean_env_wait_ms": 267.9051662502395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021167099475860596, "StateBufferConnector_ms": 0.015667080879211426, "ViewRequirementAgentConnector_ms": 1.0785683989524841}}, "episode_reward_max": -155535.38123424863, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -157364.57105358684, "episode_len_mean": 720.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902, -157918.28919593635, -157211.36051161523, -157916.480700045, -156816.1554743655], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.597392576728396, "mean_inference_ms": 1.2507846654823942, "mean_action_processing_ms": 0.962642544988273, "mean_env_wait_ms": 267.9051662502395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021167099475860596, "StateBufferConnector_ms": 0.015667080879211426, "ViewRequirementAgentConnector_ms": 1.0785683989524841}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204800, "num_agent_steps_trained": 204800, "num_env_steps_sampled": 12800, "num_env_steps_trained": 12800, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "timesteps_total": 12800, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 204800, "timers": {"training_iteration_time_ms": 33744.306, "sample_time_ms": 28923.376, "load_time_ms": 0.1, "load_throughput": 5113056.305, "learn_time_ms": 4816.488, "learn_throughput": 106.302, "synch_weights_time_ms": 3.83}, "counters": {"num_env_steps_sampled": 12800, "num_env_steps_trained": 12800, "num_agent_steps_sampled": 204800, "num_agent_steps_trained": 204800}, "done": false, "episodes_total": 16, "training_iteration": 25, "trial_id": "0eff4_00000", "date": "2023-05-29_12-31-36", "timestamp": 1685359896, "time_this_iter_s": 33.59338021278381, "time_total_s": 979.5821738243103, "pid": 19016, "hostname": "JM-M16", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "grid4x4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 2e-05, "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.4, vf_clip_param=10.0, entropy_coeff=0.1, vf_loss_coeff=0.25, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 23423, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001BE3549C550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 979.5821738243103, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 3.522222222222223, "ram_util_percent": 42.18666666666667, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5907298173289746, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": 2.284041695203632, "policy_loss": -0.009670026271487586, "vf_loss": 9.985542538017034, "vf_explained_var": -1.955777406692505e-09, "kl": 0.017442601432776428, "entropy": 2.0354603606276216, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 32640.5, "diff_num_grad_updates_vs_sampler_policy": 639.5}}, "num_env_steps_sampled": 13312, "num_env_steps_trained": 13312, "num_agent_steps_sampled": 212992, "num_agent_steps_trained": 212992}, "sampler_results": {"episode_reward_max": -155535.38123424863, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -157364.57105358684, "episode_len_mean": 720.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902, -157918.28919593635, -157211.36051161523, -157916.480700045, -156816.1554743655], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.597392576728396, "mean_inference_ms": 1.2507846654823942, "mean_action_processing_ms": 0.962642544988273, "mean_env_wait_ms": 267.9051662502395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021167099475860596, "StateBufferConnector_ms": 0.015667080879211426, "ViewRequirementAgentConnector_ms": 1.0785683989524841}}, "episode_reward_max": -155535.38123424863, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -157364.57105358684, "episode_len_mean": 720.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902, -157918.28919593635, -157211.36051161523, -157916.480700045, -156816.1554743655], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.597392576728396, "mean_inference_ms": 1.2507846654823942, "mean_action_processing_ms": 0.962642544988273, "mean_env_wait_ms": 267.9051662502395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021167099475860596, "StateBufferConnector_ms": 0.015667080879211426, "ViewRequirementAgentConnector_ms": 1.0785683989524841}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212992, "num_agent_steps_trained": 212992, "num_env_steps_sampled": 13312, "num_env_steps_trained": 13312, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "timesteps_total": 13312, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 212992, "timers": {"training_iteration_time_ms": 33648.422, "sample_time_ms": 28821.552, "load_time_ms": 0.196, "load_throughput": 2612510.521, "learn_time_ms": 4822.534, "learn_throughput": 106.168, "synch_weights_time_ms": 3.828}, "counters": {"num_env_steps_sampled": 13312, "num_env_steps_trained": 13312, "num_agent_steps_sampled": 212992, "num_agent_steps_trained": 212992}, "done": false, "episodes_total": 16, "training_iteration": 26, "trial_id": "0eff4_00000", "date": "2023-05-29_12-32-16", "timestamp": 1685359936, "time_this_iter_s": 40.29213070869446, "time_total_s": 1019.8743045330048, "pid": 19016, "hostname": "JM-M16", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "grid4x4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 2e-05, "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.4, vf_clip_param=10.0, entropy_coeff=0.1, vf_loss_coeff=0.25, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 23423, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001BE3549C550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1019.8743045330048, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 3.2811320754716977, "ram_util_percent": 42.03207547169811, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6121543871005997, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": 2.2739016065374016, "policy_loss": -0.008426260546548292, "vf_loss": 9.940379844605923, "vf_explained_var": -1.057051122188568e-08, "kl": 0.01454537824356521, "entropy": 2.034943672455847, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33920.5, "diff_num_grad_updates_vs_sampler_policy": 639.5}}, "num_env_steps_sampled": 13824, "num_env_steps_trained": 13824, "num_agent_steps_sampled": 221184, "num_agent_steps_trained": 221184}, "sampler_results": {"episode_reward_max": -155535.38123424863, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -157364.57105358684, "episode_len_mean": 720.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902, -157918.28919593635, -157211.36051161523, -157916.480700045, -156816.1554743655], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.597392576728396, "mean_inference_ms": 1.2507846654823942, "mean_action_processing_ms": 0.962642544988273, "mean_env_wait_ms": 267.9051662502395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021167099475860596, "StateBufferConnector_ms": 0.015667080879211426, "ViewRequirementAgentConnector_ms": 1.0785683989524841}}, "episode_reward_max": -155535.38123424863, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -157364.57105358684, "episode_len_mean": 720.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902, -157918.28919593635, -157211.36051161523, -157916.480700045, -156816.1554743655], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.597392576728396, "mean_inference_ms": 1.2507846654823942, "mean_action_processing_ms": 0.962642544988273, "mean_env_wait_ms": 267.9051662502395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021167099475860596, "StateBufferConnector_ms": 0.015667080879211426, "ViewRequirementAgentConnector_ms": 1.0785683989524841}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 221184, "num_agent_steps_trained": 221184, "num_env_steps_sampled": 13824, "num_env_steps_trained": 13824, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "timesteps_total": 13824, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 221184, "timers": {"training_iteration_time_ms": 33998.704, "sample_time_ms": 29164.293, "load_time_ms": 0.196, "load_throughput": 2612510.521, "learn_time_ms": 4830.122, "learn_throughput": 106.001, "synch_weights_time_ms": 3.781}, "counters": {"num_env_steps_sampled": 13824, "num_env_steps_trained": 13824, "num_agent_steps_sampled": 221184, "num_agent_steps_trained": 221184}, "done": false, "episodes_total": 16, "training_iteration": 27, "trial_id": "0eff4_00000", "date": "2023-05-29_12-32-51", "timestamp": 1685359971, "time_this_iter_s": 34.36188292503357, "time_total_s": 1054.2361874580383, "pid": 19016, "hostname": "JM-M16", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "grid4x4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 2e-05, "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.4, vf_clip_param=10.0, entropy_coeff=0.1, vf_loss_coeff=0.25, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 23423, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001BE3549C550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1054.2361874580383, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 3.9804347826086963, "ram_util_percent": 42.036956521739114, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5784229038632475, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": 2.27060779966414, "policy_loss": -0.004708888608729467, "vf_loss": 9.913186348974705, "vf_explained_var": -2.2817403078079225e-09, "kl": 0.014097345285699702, "entropy": 2.0368476431816815, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 35200.5, "diff_num_grad_updates_vs_sampler_policy": 639.5}}, "num_env_steps_sampled": 14336, "num_env_steps_trained": 14336, "num_agent_steps_sampled": 229376, "num_agent_steps_trained": 229376}, "sampler_results": {"episode_reward_max": -155535.38123424863, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -157364.57105358684, "episode_len_mean": 720.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902, -157918.28919593635, -157211.36051161523, -157916.480700045, -156816.1554743655], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.597392576728396, "mean_inference_ms": 1.2507846654823942, "mean_action_processing_ms": 0.962642544988273, "mean_env_wait_ms": 267.9051662502395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021167099475860596, "StateBufferConnector_ms": 0.015667080879211426, "ViewRequirementAgentConnector_ms": 1.0785683989524841}}, "episode_reward_max": -155535.38123424863, "episode_reward_min": -160280.26108831333, "episode_reward_mean": -157364.57105358684, "episode_len_mean": 720.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902, -157918.28919593635, -157211.36051161523, -157916.480700045, -156816.1554743655], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.597392576728396, "mean_inference_ms": 1.2507846654823942, "mean_action_processing_ms": 0.962642544988273, "mean_env_wait_ms": 267.9051662502395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021167099475860596, "StateBufferConnector_ms": 0.015667080879211426, "ViewRequirementAgentConnector_ms": 1.0785683989524841}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 229376, "num_agent_steps_trained": 229376, "num_env_steps_sampled": 14336, "num_env_steps_trained": 14336, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "timesteps_total": 14336, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 229376, "timers": {"training_iteration_time_ms": 34102.943, "sample_time_ms": 29258.677, "load_time_ms": 0.296, "load_throughput": 1726967.148, "learn_time_ms": 4839.869, "learn_throughput": 105.788, "synch_weights_time_ms": 3.785}, "counters": {"num_env_steps_sampled": 14336, "num_env_steps_trained": 14336, "num_agent_steps_sampled": 229376, "num_agent_steps_trained": 229376}, "done": false, "episodes_total": 16, "training_iteration": 28, "trial_id": "0eff4_00000", "date": "2023-05-29_12-33-22", "timestamp": 1685360002, "time_this_iter_s": 31.282759189605713, "time_total_s": 1085.518946647644, "pid": 19016, "hostname": "JM-M16", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "grid4x4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 2e-05, "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.4, vf_clip_param=10.0, entropy_coeff=0.1, vf_loss_coeff=0.25, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 23423, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001BE3549C550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1085.518946647644, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 2.311904761904762, "ram_util_percent": 42.01190476190476, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6221995968138799, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": 2.239932388300076, "policy_loss": -0.007714017549005803, "vf_loss": 9.800778770446778, "vf_explained_var": -0.0022408331278711557, "kl": 0.017188658209488495, "entropy": 2.0340772062540053, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 36480.5, "diff_num_grad_updates_vs_sampler_policy": 639.5}}, "num_env_steps_sampled": 14848, "num_env_steps_trained": 14848, "num_agent_steps_sampled": 237568, "num_agent_steps_trained": 237568}, "sampler_results": {"episode_reward_max": -155535.38123424863, "episode_reward_min": -160522.95889324043, "episode_reward_mean": -157500.51864138813, "episode_len_mean": 720.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902, -157918.28919593635, -157211.36051161523, -157916.480700045, -156816.1554743655, -156385.74005872483, -157915.55144845456, -157352.98556995366, -160522.95889324043], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5804451140201636, "mean_inference_ms": 1.2433283200841554, "mean_action_processing_ms": 0.9506533329501521, "mean_env_wait_ms": 264.55060924853035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016933679580688477, "StateBufferConnector_ms": 0.01253366470336914, "ViewRequirementAgentConnector_ms": 0.9961307048797607}}, "episode_reward_max": -155535.38123424863, "episode_reward_min": -160522.95889324043, "episode_reward_mean": -157500.51864138813, "episode_len_mean": 720.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902, -157918.28919593635, -157211.36051161523, -157916.480700045, -156816.1554743655, -156385.74005872483, -157915.55144845456, -157352.98556995366, -160522.95889324043], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5804451140201636, "mean_inference_ms": 1.2433283200841554, "mean_action_processing_ms": 0.9506533329501521, "mean_env_wait_ms": 264.55060924853035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016933679580688477, "StateBufferConnector_ms": 0.01253366470336914, "ViewRequirementAgentConnector_ms": 0.9961307048797607}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 237568, "num_agent_steps_trained": 237568, "num_env_steps_sampled": 14848, "num_env_steps_trained": 14848, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "timesteps_total": 14848, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 237568, "timers": {"training_iteration_time_ms": 33959.05, "sample_time_ms": 29116.23, "load_time_ms": 0.294, "load_throughput": 1742097.548, "learn_time_ms": 4837.969, "learn_throughput": 105.83, "synch_weights_time_ms": 4.141}, "counters": {"num_env_steps_sampled": 14848, "num_env_steps_trained": 14848, "num_agent_steps_sampled": 237568, "num_agent_steps_trained": 237568}, "done": false, "episodes_total": 20, "training_iteration": 29, "trial_id": "0eff4_00000", "date": "2023-05-29_12-33-52", "timestamp": 1685360032, "time_this_iter_s": 30.585553884506226, "time_total_s": 1116.1045005321503, "pid": 19016, "hostname": "JM-M16", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "grid4x4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 2e-05, "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.4, vf_clip_param=10.0, entropy_coeff=0.1, vf_loss_coeff=0.25, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 23423, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001BE3549C550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1116.1045005321503, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 2.241463414634146, "ram_util_percent": 41.982926829268294, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5743577095970978, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": 2.2796829568222163, "policy_loss": -0.0031518884366960264, "vf_loss": 9.943077709525824, "vf_explained_var": -3.3527612686157227e-09, "kl": 0.019235937510529766, "entropy": 2.0389637794345616, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 37760.5, "diff_num_grad_updates_vs_sampler_policy": 639.5}}, "num_env_steps_sampled": 15360, "num_env_steps_trained": 15360, "num_agent_steps_sampled": 245760, "num_agent_steps_trained": 245760}, "sampler_results": {"episode_reward_max": -155535.38123424863, "episode_reward_min": -160522.95889324043, "episode_reward_mean": -157500.51864138813, "episode_len_mean": 720.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902, -157918.28919593635, -157211.36051161523, -157916.480700045, -156816.1554743655, -156385.74005872483, -157915.55144845456, -157352.98556995366, -160522.95889324043], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5804451140201636, "mean_inference_ms": 1.2433283200841554, "mean_action_processing_ms": 0.9506533329501521, "mean_env_wait_ms": 264.55060924853035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016933679580688477, "StateBufferConnector_ms": 0.01253366470336914, "ViewRequirementAgentConnector_ms": 0.9961307048797607}}, "episode_reward_max": -155535.38123424863, "episode_reward_min": -160522.95889324043, "episode_reward_mean": -157500.51864138813, "episode_len_mean": 720.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902, -157918.28919593635, -157211.36051161523, -157916.480700045, -156816.1554743655, -156385.74005872483, -157915.55144845456, -157352.98556995366, -160522.95889324043], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5804451140201636, "mean_inference_ms": 1.2433283200841554, "mean_action_processing_ms": 0.9506533329501521, "mean_env_wait_ms": 264.55060924853035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016933679580688477, "StateBufferConnector_ms": 0.01253366470336914, "ViewRequirementAgentConnector_ms": 0.9961307048797607}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 245760, "num_agent_steps_trained": 245760, "num_env_steps_sampled": 15360, "num_env_steps_trained": 15360, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "timesteps_total": 15360, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 245760, "timers": {"training_iteration_time_ms": 33336.197, "sample_time_ms": 28489.041, "load_time_ms": 0.294, "load_throughput": 1742097.548, "learn_time_ms": 4842.336, "learn_throughput": 105.734, "synch_weights_time_ms": 4.11}, "counters": {"num_env_steps_sampled": 15360, "num_env_steps_trained": 15360, "num_agent_steps_sampled": 245760, "num_agent_steps_trained": 245760}, "done": false, "episodes_total": 20, "training_iteration": 30, "trial_id": "0eff4_00000", "date": "2023-05-29_12-34-25", "timestamp": 1685360065, "time_this_iter_s": 32.00526833534241, "time_total_s": 1148.1097688674927, "pid": 19016, "hostname": "JM-M16", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "grid4x4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 2e-05, "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.4, vf_clip_param=10.0, entropy_coeff=0.1, vf_loss_coeff=0.25, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 23423, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001BE3549C550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1148.1097688674927, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 1.6595238095238096, "ram_util_percent": 41.945238095238096, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5736337517155334, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": 2.2841019720770417, "policy_loss": -0.009128431559656747, "vf_loss": 9.984274140745402, "vf_explained_var": -5.727633833885193e-09, "kl": 0.016963317916088273, "entropy": 2.036862884089351, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 39040.5, "diff_num_grad_updates_vs_sampler_policy": 639.5}}, "num_env_steps_sampled": 15872, "num_env_steps_trained": 15872, "num_agent_steps_sampled": 253952, "num_agent_steps_trained": 253952}, "sampler_results": {"episode_reward_max": -155535.38123424863, "episode_reward_min": -160522.95889324043, "episode_reward_mean": -157500.51864138813, "episode_len_mean": 720.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902, -157918.28919593635, -157211.36051161523, -157916.480700045, -156816.1554743655, -156385.74005872483, -157915.55144845456, -157352.98556995366, -160522.95889324043], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5804451140201636, "mean_inference_ms": 1.2433283200841554, "mean_action_processing_ms": 0.9506533329501521, "mean_env_wait_ms": 264.55060924853035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016933679580688477, "StateBufferConnector_ms": 0.01253366470336914, "ViewRequirementAgentConnector_ms": 0.9961307048797607}}, "episode_reward_max": -155535.38123424863, "episode_reward_min": -160522.95889324043, "episode_reward_mean": -157500.51864138813, "episode_len_mean": 720.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902, -157918.28919593635, -157211.36051161523, -157916.480700045, -156816.1554743655, -156385.74005872483, -157915.55144845456, -157352.98556995366, -160522.95889324043], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5804451140201636, "mean_inference_ms": 1.2433283200841554, "mean_action_processing_ms": 0.9506533329501521, "mean_env_wait_ms": 264.55060924853035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016933679580688477, "StateBufferConnector_ms": 0.01253366470336914, "ViewRequirementAgentConnector_ms": 0.9961307048797607}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 253952, "num_agent_steps_trained": 253952, "num_env_steps_sampled": 15872, "num_env_steps_trained": 15872, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "timesteps_total": 15872, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 253952, "timers": {"training_iteration_time_ms": 33283.024, "sample_time_ms": 28423.601, "load_time_ms": 0.294, "load_throughput": 1742097.548, "learn_time_ms": 4854.59, "learn_throughput": 105.467, "synch_weights_time_ms": 4.225}, "counters": {"num_env_steps_sampled": 15872, "num_env_steps_trained": 15872, "num_agent_steps_sampled": 253952, "num_agent_steps_trained": 253952}, "done": false, "episodes_total": 20, "training_iteration": 31, "trial_id": "0eff4_00000", "date": "2023-05-29_12-35-01", "timestamp": 1685360101, "time_this_iter_s": 36.10844421386719, "time_total_s": 1184.2182130813599, "pid": 19016, "hostname": "JM-M16", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "grid4x4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 2e-05, "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.4, vf_clip_param=10.0, entropy_coeff=0.1, vf_loss_coeff=0.25, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 23423, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001BE3549C550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1184.2182130813599, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 1.9916666666666665, "ram_util_percent": 42.0, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5767072908289265, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": 2.279358038213104, "policy_loss": -0.007320848971357918, "vf_loss": 9.960033789277077, "vf_explained_var": -2.3283064365386963e-09, "kl": 0.01656254489425919, "entropy": 2.0415768712759017, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 40320.5, "diff_num_grad_updates_vs_sampler_policy": 639.5}}, "num_env_steps_sampled": 16384, "num_env_steps_trained": 16384, "num_agent_steps_sampled": 262144, "num_agent_steps_trained": 262144}, "sampler_results": {"episode_reward_max": -155535.38123424863, "episode_reward_min": -160522.95889324043, "episode_reward_mean": -157500.51864138813, "episode_len_mean": 720.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902, -157918.28919593635, -157211.36051161523, -157916.480700045, -156816.1554743655, -156385.74005872483, -157915.55144845456, -157352.98556995366, -160522.95889324043], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5804451140201636, "mean_inference_ms": 1.2433283200841554, "mean_action_processing_ms": 0.9506533329501521, "mean_env_wait_ms": 264.55060924853035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016933679580688477, "StateBufferConnector_ms": 0.01253366470336914, "ViewRequirementAgentConnector_ms": 0.9961307048797607}}, "episode_reward_max": -155535.38123424863, "episode_reward_min": -160522.95889324043, "episode_reward_mean": -157500.51864138813, "episode_len_mean": 720.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902, -157918.28919593635, -157211.36051161523, -157916.480700045, -156816.1554743655, -156385.74005872483, -157915.55144845456, -157352.98556995366, -160522.95889324043], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5804451140201636, "mean_inference_ms": 1.2433283200841554, "mean_action_processing_ms": 0.9506533329501521, "mean_env_wait_ms": 264.55060924853035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016933679580688477, "StateBufferConnector_ms": 0.01253366470336914, "ViewRequirementAgentConnector_ms": 0.9961307048797607}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 262144, "num_agent_steps_trained": 262144, "num_env_steps_sampled": 16384, "num_env_steps_trained": 16384, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "timesteps_total": 16384, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 262144, "timers": {"training_iteration_time_ms": 34002.528, "sample_time_ms": 29161.508, "load_time_ms": 0.294, "load_throughput": 1742097.548, "learn_time_ms": 4836.158, "learn_throughput": 105.869, "synch_weights_time_ms": 4.265}, "counters": {"num_env_steps_sampled": 16384, "num_env_steps_trained": 16384, "num_agent_steps_sampled": 262144, "num_agent_steps_trained": 262144}, "done": false, "episodes_total": 20, "training_iteration": 32, "trial_id": "0eff4_00000", "date": "2023-05-29_12-35-40", "timestamp": 1685360140, "time_this_iter_s": 39.0746910572052, "time_total_s": 1223.292904138565, "pid": 19016, "hostname": "JM-M16", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "grid4x4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 2e-05, "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.4, vf_clip_param=10.0, entropy_coeff=0.1, vf_loss_coeff=0.25, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 23423, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001BE3549C550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1223.292904138565, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 4.179245283018869, "ram_util_percent": 41.971698113207545, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5825564876256977, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": 2.270470319595188, "policy_loss": -0.008846392890700373, "vf_loss": 9.927589210122823, "vf_explained_var": -7.450580596923828e-09, "kl": 0.016158594060470932, "entropy": 2.0338852025568483, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 41600.5, "diff_num_grad_updates_vs_sampler_policy": 639.5}}, "num_env_steps_sampled": 16896, "num_env_steps_trained": 16896, "num_agent_steps_sampled": 270336, "num_agent_steps_trained": 270336}, "sampler_results": {"episode_reward_max": -155535.38123424863, "episode_reward_min": -160522.95889324043, "episode_reward_mean": -157500.51864138813, "episode_len_mean": 720.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902, -157918.28919593635, -157211.36051161523, -157916.480700045, -156816.1554743655, -156385.74005872483, -157915.55144845456, -157352.98556995366, -160522.95889324043], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5804451140201636, "mean_inference_ms": 1.2433283200841554, "mean_action_processing_ms": 0.9506533329501521, "mean_env_wait_ms": 264.55060924853035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016933679580688477, "StateBufferConnector_ms": 0.01253366470336914, "ViewRequirementAgentConnector_ms": 0.9961307048797607}}, "episode_reward_max": -155535.38123424863, "episode_reward_min": -160522.95889324043, "episode_reward_mean": -157500.51864138813, "episode_len_mean": 720.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902, -157918.28919593635, -157211.36051161523, -157916.480700045, -156816.1554743655, -156385.74005872483, -157915.55144845456, -157352.98556995366, -160522.95889324043], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5804451140201636, "mean_inference_ms": 1.2433283200841554, "mean_action_processing_ms": 0.9506533329501521, "mean_env_wait_ms": 264.55060924853035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016933679580688477, "StateBufferConnector_ms": 0.01253366470336914, "ViewRequirementAgentConnector_ms": 0.9961307048797607}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 270336, "num_agent_steps_trained": 270336, "num_env_steps_sampled": 16896, "num_env_steps_trained": 16896, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "timesteps_total": 16896, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 270336, "timers": {"training_iteration_time_ms": 34100.523, "sample_time_ms": 29237.499, "load_time_ms": 0.294, "load_throughput": 1742097.548, "learn_time_ms": 4858.153, "learn_throughput": 105.39, "synch_weights_time_ms": 4.274}, "counters": {"num_env_steps_sampled": 16896, "num_env_steps_trained": 16896, "num_agent_steps_sampled": 270336, "num_agent_steps_trained": 270336}, "done": false, "episodes_total": 20, "training_iteration": 33, "trial_id": "0eff4_00000", "date": "2023-05-29_12-36-13", "timestamp": 1685360173, "time_this_iter_s": 32.859086751937866, "time_total_s": 1256.151990890503, "pid": 19016, "hostname": "JM-M16", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "grid4x4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 2e-05, "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.4, vf_clip_param=10.0, entropy_coeff=0.1, vf_loss_coeff=0.25, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 23423, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001BE3549C550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1256.151990890503, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 3.7209302325581404, "ram_util_percent": 41.94418604651163, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6709336036001332, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": 2.2227513785939665, "policy_loss": -0.005699864298730972, "vf_loss": 9.723806089162826, "vf_explained_var": 0.0009970662649720907, "kl": 0.015772277845826466, "entropy": 2.032888918556273, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 42880.5, "diff_num_grad_updates_vs_sampler_policy": 639.5}}, "num_env_steps_sampled": 17408, "num_env_steps_trained": 17408, "num_agent_steps_sampled": 278528, "num_agent_steps_trained": 278528}, "sampler_results": {"episode_reward_max": -155535.38123424863, "episode_reward_min": -160522.95889324043, "episode_reward_mean": -157617.14515322278, "episode_len_mean": 720.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902, -157918.28919593635, -157211.36051161523, -157916.480700045, -156816.1554743655, -156385.74005872483, -157915.55144845456, -157352.98556995366, -160522.95889324043, -158144.57816175267, -158844.97036079224, -157027.14811957203, -158784.41420746644], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5666899392119826, "mean_inference_ms": 1.2352217811563098, "mean_action_processing_ms": 0.9397336563902172, "mean_env_wait_ms": 261.5996183133622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01411139965057373, "StateBufferConnector_ms": 0.010444720586140951, "ViewRequirementAgentConnector_ms": 0.9846011797587076}}, "episode_reward_max": -155535.38123424863, "episode_reward_min": -160522.95889324043, "episode_reward_mean": -157617.14515322278, "episode_len_mean": 720.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902, -157918.28919593635, -157211.36051161523, -157916.480700045, -156816.1554743655, -156385.74005872483, -157915.55144845456, -157352.98556995366, -160522.95889324043, -158144.57816175267, -158844.97036079224, -157027.14811957203, -158784.41420746644], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5666899392119826, "mean_inference_ms": 1.2352217811563098, "mean_action_processing_ms": 0.9397336563902172, "mean_env_wait_ms": 261.5996183133622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01411139965057373, "StateBufferConnector_ms": 0.010444720586140951, "ViewRequirementAgentConnector_ms": 0.9846011797587076}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 278528, "num_agent_steps_trained": 278528, "num_env_steps_sampled": 17408, "num_env_steps_trained": 17408, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "timesteps_total": 17408, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 278528, "timers": {"training_iteration_time_ms": 34093.699, "sample_time_ms": 29233.223, "load_time_ms": 0.393, "load_throughput": 1304034.277, "learn_time_ms": 4855.539, "learn_throughput": 105.447, "synch_weights_time_ms": 4.242}, "counters": {"num_env_steps_sampled": 17408, "num_env_steps_trained": 17408, "num_agent_steps_sampled": 278528, "num_agent_steps_trained": 278528}, "done": false, "episodes_total": 24, "training_iteration": 34, "trial_id": "0eff4_00000", "date": "2023-05-29_12-36-43", "timestamp": 1685360203, "time_this_iter_s": 30.812872886657715, "time_total_s": 1286.9648637771606, "pid": 19016, "hostname": "JM-M16", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "grid4x4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 2e-05, "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.4, vf_clip_param=10.0, entropy_coeff=0.1, vf_loss_coeff=0.25, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 23423, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001BE3549C550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1286.9648637771606, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 4.173170731707317, "ram_util_percent": 41.97560975609757, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.592769283533562, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": 2.2662349357269704, "policy_loss": -0.004196130440686829, "vf_loss": 9.892362524569034, "vf_explained_var": -8.800998330116271e-09, "kl": 0.014836763511266327, "entropy": 2.034014037437737, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 44160.5, "diff_num_grad_updates_vs_sampler_policy": 639.5}}, "num_env_steps_sampled": 17920, "num_env_steps_trained": 17920, "num_agent_steps_sampled": 286720, "num_agent_steps_trained": 286720}, "sampler_results": {"episode_reward_max": -155535.38123424863, "episode_reward_min": -160522.95889324043, "episode_reward_mean": -157617.14515322278, "episode_len_mean": 720.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902, -157918.28919593635, -157211.36051161523, -157916.480700045, -156816.1554743655, -156385.74005872483, -157915.55144845456, -157352.98556995366, -160522.95889324043, -158144.57816175267, -158844.97036079224, -157027.14811957203, -158784.41420746644], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5666899392119826, "mean_inference_ms": 1.2352217811563098, "mean_action_processing_ms": 0.9397336563902172, "mean_env_wait_ms": 261.5996183133622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01411139965057373, "StateBufferConnector_ms": 0.010444720586140951, "ViewRequirementAgentConnector_ms": 0.9846011797587076}}, "episode_reward_max": -155535.38123424863, "episode_reward_min": -160522.95889324043, "episode_reward_mean": -157617.14515322278, "episode_len_mean": 720.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902, -157918.28919593635, -157211.36051161523, -157916.480700045, -156816.1554743655, -156385.74005872483, -157915.55144845456, -157352.98556995366, -160522.95889324043, -158144.57816175267, -158844.97036079224, -157027.14811957203, -158784.41420746644], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5666899392119826, "mean_inference_ms": 1.2352217811563098, "mean_action_processing_ms": 0.9397336563902172, "mean_env_wait_ms": 261.5996183133622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01411139965057373, "StateBufferConnector_ms": 0.010444720586140951, "ViewRequirementAgentConnector_ms": 0.9846011797587076}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 286720, "num_agent_steps_trained": 286720, "num_env_steps_sampled": 17920, "num_env_steps_trained": 17920, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "timesteps_total": 17920, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 286720, "timers": {"training_iteration_time_ms": 33768.66, "sample_time_ms": 28898.776, "load_time_ms": 0.393, "load_throughput": 1304034.277, "learn_time_ms": 4865.306, "learn_throughput": 105.235, "synch_weights_time_ms": 3.883}, "counters": {"num_env_steps_sampled": 17920, "num_env_steps_trained": 17920, "num_agent_steps_sampled": 286720, "num_agent_steps_trained": 286720}, "done": false, "episodes_total": 24, "training_iteration": 35, "trial_id": "0eff4_00000", "date": "2023-05-29_12-37-14", "timestamp": 1685360234, "time_this_iter_s": 30.34398317337036, "time_total_s": 1317.308846950531, "pid": 19016, "hostname": "JM-M16", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "grid4x4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 2e-05, "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.4, vf_clip_param=10.0, entropy_coeff=0.1, vf_loss_coeff=0.25, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 23423, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001BE3549C550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1317.308846950531, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 4.7073170731707314, "ram_util_percent": 41.926829268292686, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5589336674660444, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": 2.2805018415674567, "policy_loss": -0.00476557731963112, "vf_loss": 9.954124028235674, "vf_explained_var": -8.800998330116271e-09, "kl": 0.014777659489118378, "entropy": 2.040024618245661, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 45440.5, "diff_num_grad_updates_vs_sampler_policy": 639.5}}, "num_env_steps_sampled": 18432, "num_env_steps_trained": 18432, "num_agent_steps_sampled": 294912, "num_agent_steps_trained": 294912}, "sampler_results": {"episode_reward_max": -155535.38123424863, "episode_reward_min": -160522.95889324043, "episode_reward_mean": -157617.14515322278, "episode_len_mean": 720.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902, -157918.28919593635, -157211.36051161523, -157916.480700045, -156816.1554743655, -156385.74005872483, -157915.55144845456, -157352.98556995366, -160522.95889324043, -158144.57816175267, -158844.97036079224, -157027.14811957203, -158784.41420746644], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5666899392119826, "mean_inference_ms": 1.2352217811563098, "mean_action_processing_ms": 0.9397336563902172, "mean_env_wait_ms": 261.5996183133622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01411139965057373, "StateBufferConnector_ms": 0.010444720586140951, "ViewRequirementAgentConnector_ms": 0.9846011797587076}}, "episode_reward_max": -155535.38123424863, "episode_reward_min": -160522.95889324043, "episode_reward_mean": -157617.14515322278, "episode_len_mean": 720.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902, -157918.28919593635, -157211.36051161523, -157916.480700045, -156816.1554743655, -156385.74005872483, -157915.55144845456, -157352.98556995366, -160522.95889324043, -158144.57816175267, -158844.97036079224, -157027.14811957203, -158784.41420746644], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5666899392119826, "mean_inference_ms": 1.2352217811563098, "mean_action_processing_ms": 0.9397336563902172, "mean_env_wait_ms": 261.5996183133622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01411139965057373, "StateBufferConnector_ms": 0.010444720586140951, "ViewRequirementAgentConnector_ms": 0.9846011797587076}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 294912, "num_agent_steps_trained": 294912, "num_env_steps_sampled": 18432, "num_env_steps_trained": 18432, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "timesteps_total": 18432, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 294912, "timers": {"training_iteration_time_ms": 32990.046, "sample_time_ms": 28122.654, "load_time_ms": 0.297, "load_throughput": 1725163.599, "learn_time_ms": 4862.294, "learn_throughput": 105.3, "synch_weights_time_ms": 4.498}, "counters": {"num_env_steps_sampled": 18432, "num_env_steps_trained": 18432, "num_agent_steps_sampled": 294912, "num_agent_steps_trained": 294912}, "done": false, "episodes_total": 24, "training_iteration": 36, "trial_id": "0eff4_00000", "date": "2023-05-29_12-37-46", "timestamp": 1685360266, "time_this_iter_s": 32.50886797904968, "time_total_s": 1349.8177149295807, "pid": 19016, "hostname": "JM-M16", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "grid4x4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 2e-05, "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.4, vf_clip_param=10.0, entropy_coeff=0.1, vf_loss_coeff=0.25, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 23423, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001BE3549C550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1349.8177149295807, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 3.1627906976744184, "ram_util_percent": 41.90697674418606, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5678545921808109, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": 2.2834843890741467, "policy_loss": -0.00950911012623692, "vf_loss": 9.983927136659622, "vf_explained_var": -4.889443516731262e-09, "kl": 0.01530242390508647, "entropy": 2.0375341076403855, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 46720.5, "diff_num_grad_updates_vs_sampler_policy": 639.5}}, "num_env_steps_sampled": 18944, "num_env_steps_trained": 18944, "num_agent_steps_sampled": 303104, "num_agent_steps_trained": 303104}, "sampler_results": {"episode_reward_max": -155535.38123424863, "episode_reward_min": -160522.95889324043, "episode_reward_mean": -157617.14515322278, "episode_len_mean": 720.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902, -157918.28919593635, -157211.36051161523, -157916.480700045, -156816.1554743655, -156385.74005872483, -157915.55144845456, -157352.98556995366, -160522.95889324043, -158144.57816175267, -158844.97036079224, -157027.14811957203, -158784.41420746644], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5666899392119826, "mean_inference_ms": 1.2352217811563098, "mean_action_processing_ms": 0.9397336563902172, "mean_env_wait_ms": 261.5996183133622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01411139965057373, "StateBufferConnector_ms": 0.010444720586140951, "ViewRequirementAgentConnector_ms": 0.9846011797587076}}, "episode_reward_max": -155535.38123424863, "episode_reward_min": -160522.95889324043, "episode_reward_mean": -157617.14515322278, "episode_len_mean": 720.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902, -157918.28919593635, -157211.36051161523, -157916.480700045, -156816.1554743655, -156385.74005872483, -157915.55144845456, -157352.98556995366, -160522.95889324043, -158144.57816175267, -158844.97036079224, -157027.14811957203, -158784.41420746644], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5666899392119826, "mean_inference_ms": 1.2352217811563098, "mean_action_processing_ms": 0.9397336563902172, "mean_env_wait_ms": 261.5996183133622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01411139965057373, "StateBufferConnector_ms": 0.010444720586140951, "ViewRequirementAgentConnector_ms": 0.9846011797587076}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 303104, "num_agent_steps_trained": 303104, "num_env_steps_sampled": 18944, "num_env_steps_trained": 18944, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "timesteps_total": 18944, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 303104, "timers": {"training_iteration_time_ms": 33480.605, "sample_time_ms": 28629.817, "load_time_ms": 0.297, "load_throughput": 1725163.599, "learn_time_ms": 4845.644, "learn_throughput": 105.662, "synch_weights_time_ms": 4.445}, "counters": {"num_env_steps_sampled": 18944, "num_env_steps_trained": 18944, "num_agent_steps_sampled": 303104, "num_agent_steps_trained": 303104}, "done": false, "episodes_total": 24, "training_iteration": 37, "trial_id": "0eff4_00000", "date": "2023-05-29_12-38-26", "timestamp": 1685360306, "time_this_iter_s": 39.26746702194214, "time_total_s": 1389.0851819515228, "pid": 19016, "hostname": "JM-M16", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "grid4x4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 2e-05, "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.4, vf_clip_param=10.0, entropy_coeff=0.1, vf_loss_coeff=0.25, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 23423, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001BE3549C550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1389.0851819515228, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 3.925, "ram_util_percent": 41.95384615384615, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5835676698246971, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": 2.2772271213121713, "policy_loss": -0.008598109470040072, "vf_loss": 9.952857004106045, "vf_explained_var": -5.541369318962097e-09, "kl": 0.01641809095890494, "entropy": 2.032099259737879, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 48000.5, "diff_num_grad_updates_vs_sampler_policy": 639.5}}, "num_env_steps_sampled": 19456, "num_env_steps_trained": 19456, "num_agent_steps_sampled": 311296, "num_agent_steps_trained": 311296}, "sampler_results": {"episode_reward_max": -155535.38123424863, "episode_reward_min": -160522.95889324043, "episode_reward_mean": -157617.14515322278, "episode_len_mean": 720.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902, -157918.28919593635, -157211.36051161523, -157916.480700045, -156816.1554743655, -156385.74005872483, -157915.55144845456, -157352.98556995366, -160522.95889324043, -158144.57816175267, -158844.97036079224, -157027.14811957203, -158784.41420746644], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5666899392119826, "mean_inference_ms": 1.2352217811563098, "mean_action_processing_ms": 0.9397336563902172, "mean_env_wait_ms": 261.5996183133622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01411139965057373, "StateBufferConnector_ms": 0.010444720586140951, "ViewRequirementAgentConnector_ms": 0.9846011797587076}}, "episode_reward_max": -155535.38123424863, "episode_reward_min": -160522.95889324043, "episode_reward_mean": -157617.14515322278, "episode_len_mean": 720.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902, -157918.28919593635, -157211.36051161523, -157916.480700045, -156816.1554743655, -156385.74005872483, -157915.55144845456, -157352.98556995366, -160522.95889324043, -158144.57816175267, -158844.97036079224, -157027.14811957203, -158784.41420746644], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5666899392119826, "mean_inference_ms": 1.2352217811563098, "mean_action_processing_ms": 0.9397336563902172, "mean_env_wait_ms": 261.5996183133622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01411139965057373, "StateBufferConnector_ms": 0.010444720586140951, "ViewRequirementAgentConnector_ms": 0.9846011797587076}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 311296, "num_agent_steps_trained": 311296, "num_env_steps_sampled": 19456, "num_env_steps_trained": 19456, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "timesteps_total": 19456, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 311296, "timers": {"training_iteration_time_ms": 33988.688, "sample_time_ms": 29145.133, "load_time_ms": 0.196, "load_throughput": 2608385.337, "learn_time_ms": 4838.511, "learn_throughput": 105.818, "synch_weights_time_ms": 4.443}, "counters": {"num_env_steps_sampled": 19456, "num_env_steps_trained": 19456, "num_agent_steps_sampled": 311296, "num_agent_steps_trained": 311296}, "done": false, "episodes_total": 24, "training_iteration": 38, "trial_id": "0eff4_00000", "date": "2023-05-29_12-39-02", "timestamp": 1685360342, "time_this_iter_s": 36.3607919216156, "time_total_s": 1425.4459738731384, "pid": 19016, "hostname": "JM-M16", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "grid4x4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 2e-05, "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.4, vf_clip_param=10.0, entropy_coeff=0.1, vf_loss_coeff=0.25, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 23423, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001BE3549C550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1425.4459738731384, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 1.4428571428571428, "ram_util_percent": 41.92448979591837, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6008521921467036, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": 2.2695645271800458, "policy_loss": -0.0034555760445073246, "vf_loss": 9.903006205707788, "vf_explained_var": -1.0244548320770264e-08, "kl": 0.016349856837041443, "entropy": 2.0354894544929265, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 49280.5, "diff_num_grad_updates_vs_sampler_policy": 639.5}}, "num_env_steps_sampled": 19968, "num_env_steps_trained": 19968, "num_agent_steps_sampled": 319488, "num_agent_steps_trained": 319488}, "sampler_results": {"episode_reward_max": -155535.38123424863, "episode_reward_min": -160522.95889324043, "episode_reward_mean": -157617.14515322278, "episode_len_mean": 720.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902, -157918.28919593635, -157211.36051161523, -157916.480700045, -156816.1554743655, -156385.74005872483, -157915.55144845456, -157352.98556995366, -160522.95889324043, -158144.57816175267, -158844.97036079224, -157027.14811957203, -158784.41420746644], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5666899392119826, "mean_inference_ms": 1.2352217811563098, "mean_action_processing_ms": 0.9397336563902172, "mean_env_wait_ms": 261.5996183133622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01411139965057373, "StateBufferConnector_ms": 0.010444720586140951, "ViewRequirementAgentConnector_ms": 0.9846011797587076}}, "episode_reward_max": -155535.38123424863, "episode_reward_min": -160522.95889324043, "episode_reward_mean": -157617.14515322278, "episode_len_mean": 720.0, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902, -157918.28919593635, -157211.36051161523, -157916.480700045, -156816.1554743655, -156385.74005872483, -157915.55144845456, -157352.98556995366, -160522.95889324043, -158144.57816175267, -158844.97036079224, -157027.14811957203, -158784.41420746644], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5666899392119826, "mean_inference_ms": 1.2352217811563098, "mean_action_processing_ms": 0.9397336563902172, "mean_env_wait_ms": 261.5996183133622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01411139965057373, "StateBufferConnector_ms": 0.010444720586140951, "ViewRequirementAgentConnector_ms": 0.9846011797587076}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 319488, "num_agent_steps_trained": 319488, "num_env_steps_sampled": 19968, "num_env_steps_trained": 19968, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "timesteps_total": 19968, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 319488, "timers": {"training_iteration_time_ms": 34070.955, "sample_time_ms": 29219.97, "load_time_ms": 0.099, "load_throughput": 5185905.936, "learn_time_ms": 4845.239, "learn_throughput": 105.671, "synch_weights_time_ms": 5.243}, "counters": {"num_env_steps_sampled": 19968, "num_env_steps_trained": 19968, "num_agent_steps_sampled": 319488, "num_agent_steps_trained": 319488}, "done": false, "episodes_total": 24, "training_iteration": 39, "trial_id": "0eff4_00000", "date": "2023-05-29_12-39-33", "timestamp": 1685360373, "time_this_iter_s": 31.407224416732788, "time_total_s": 1456.8531982898712, "pid": 19016, "hostname": "JM-M16", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "grid4x4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 2e-05, "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.4, vf_clip_param=10.0, entropy_coeff=0.1, vf_loss_coeff=0.25, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 23423, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001BE3549C550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1456.8531982898712, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 4.107142857142858, "ram_util_percent": 41.00000000000001, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6163401541416533, "cur_kl_coeff": 0.049999999999999996, "cur_lr": 2e-05, "total_loss": 2.217788559105247, "policy_loss": -0.007346742392110172, "vf_loss": 9.715295534580946, "vf_explained_var": -0.00021581239998340606, "kl": 0.01683097273853491, "entropy": 2.04530130866915, "entropy_coeff": 0.09999999999999999}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 50560.5, "diff_num_grad_updates_vs_sampler_policy": 639.5}}, "num_env_steps_sampled": 20480, "num_env_steps_trained": 20480, "num_agent_steps_sampled": 327680, "num_agent_steps_trained": 327680}, "sampler_results": {"episode_reward_max": -155535.38123424863, "episode_reward_min": -160522.95889324043, "episode_reward_mean": -157777.99955753246, "episode_len_mean": 720.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902, -157918.28919593635, -157211.36051161523, -157916.480700045, -156816.1554743655, -156385.74005872483, -157915.55144845456, -157352.98556995366, -160522.95889324043, -158144.57816175267, -158844.97036079224, -157027.14811957203, -158784.41420746644, -158469.43730976066, -158217.68593029008, -159393.00768853506, -158892.37300497692], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5511199895190595, "mean_inference_ms": 1.2287754297472107, "mean_action_processing_ms": 0.930444254897651, "mean_env_wait_ms": 258.8603000503735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01924208232334682, "StateBufferConnector_ms": 0.008952617645263672, "ViewRequirementAgentConnector_ms": 0.9215669972555978}}, "episode_reward_max": -155535.38123424863, "episode_reward_min": -160522.95889324043, "episode_reward_mean": -157777.99955753246, "episode_len_mean": 720.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-160280.26108831333, -157154.63509367846, -158745.64309334048, -156532.1390244883, -155535.38123424863, -156194.85931355637, -156415.0910506653, -156025.57816409157, -157375.01238850085, -158680.66344910784, -156608.42256644752, -158423.16450898902, -157918.28919593635, -157211.36051161523, -157916.480700045, -156816.1554743655, -156385.74005872483, -157915.55144845456, -157352.98556995366, -160522.95889324043, -158144.57816175267, -158844.97036079224, -157027.14811957203, -158784.41420746644, -158469.43730976066, -158217.68593029008, -159393.00768853506, -158892.37300497692], "episode_lengths": [720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720, 720]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.5511199895190595, "mean_inference_ms": 1.2287754297472107, "mean_action_processing_ms": 0.930444254897651, "mean_env_wait_ms": 258.8603000503735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01924208232334682, "StateBufferConnector_ms": 0.008952617645263672, "ViewRequirementAgentConnector_ms": 0.9215669972555978}, "num_healthy_workers": 4, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 327680, "num_agent_steps_trained": 327680, "num_env_steps_sampled": 20480, "num_env_steps_trained": 20480, "num_env_steps_sampled_this_iter": 512, "num_env_steps_trained_this_iter": 512, "timesteps_total": 20480, "num_steps_trained_this_iter": 512, "agent_timesteps_total": 327680, "timers": {"training_iteration_time_ms": 33939.06, "sample_time_ms": 29108.284, "load_time_ms": 0.099, "load_throughput": 5185905.936, "learn_time_ms": 4824.834, "learn_throughput": 106.118, "synch_weights_time_ms": 5.339}, "counters": {"num_env_steps_sampled": 20480, "num_env_steps_trained": 20480, "num_agent_steps_sampled": 327680, "num_agent_steps_trained": 327680}, "done": true, "episodes_total": 28, "training_iteration": 40, "trial_id": "0eff4_00000", "date": "2023-05-29_12-40-04", "timestamp": 1685360404, "time_this_iter_s": 30.686310052871704, "time_total_s": 1487.539508342743, "pid": 19016, "hostname": "JM-M16", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "grid4x4", "env_config": {}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 128, "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 2e-05, "train_batch_size": 512, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "learner_class": null, "_enable_learner_api": false, "_learner_hps": "PPOLearnerHPs(kl_coeff=0.2, kl_target=0.01, use_critic=True, clip_param=0.4, vf_clip_param=10.0, entropy_coeff=0.1, vf_loss_coeff=0.25, lr_schedule=None, entropy_coeff_schedule=None)", "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 23423, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_validate_exploration_conf_and_rl_modules": true, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "simple_optimizer": false, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 64, "num_sgd_iter": 10, "shuffle_sequences": true, "vf_loss_coeff": 0.25, "entropy_coeff": 0.1, "entropy_coeff_schedule": null, "clip_param": 0.4, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.9, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x000001BE3549C550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 4}, "time_since_restore": 1487.539508342743, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 3.9425, "ram_util_percent": 40.9, "gpu_util_percent0": 0.0, "vram_util_percent0": 0.0}}
